<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tidy meteoland • meteoland</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tidy meteoland">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">meteoland</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Using meteoland</h6></li>
    <li><a class="dropdown-item" href="../articles/tidy-meteoland.html">Tidy meteoland</a></li>
    <li><a class="dropdown-item" href="../articles/reshaping-meteo.html">Reshaping meteorological data for meteoland</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/examples/interpolation-senegal.html">Daily weather interpolation over Senegal</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidy meteoland</h1>
                        <h4 data-toc-skip class="author">Victor
Granda</h4>
            
      

      <div class="d-none name"><code>tidy-meteoland.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/meteoland/index.html">meteoland</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Package 'meteoland' [ver. 2.2.1]</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: abind</span></span>
<span><span class="co">#&gt; Loading required package: sf</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<div class="section level3">
<h3 id="a-new-way-of-working-with-meteoland">A new way of working with <code>meteoland</code><a class="anchor" aria-label="anchor" href="#a-new-way-of-working-with-meteoland"></a>
</h3>
<p>With the <a href="https://r-spatial.org/r/2022/04/12/evolution.html" class="external-link">retirement</a>
of <code>rgdal</code>, <code>rgeos</code> and <code>maptools</code> R
packages, a complete update of <code>meteoland</code> was necessary to
remove the hard dependency <code>meteoland</code> has with
<code>sp</code> and <code>raster</code> R packages. Starting with
version 2.0.0 of <code>meteoland</code>, any hard dependency on retired
packages as well as <code>sp</code> and <code>raster</code> has been
removed, and now <code>sf</code> and <code>stars</code> packages are
internally used for working with simple features and raster data.</p>
<p>By June 2023, <code>sp</code> and <code>raster</code> packages will
be completely removed from the dependency list.</p>
<p>As fundamental changes were required (<code>meteoland</code>
meteorology classes were based on <code>sp</code> ones), a decision to
improve and make meteorological interpolation process simpler was taken.
In this vignette, we provide insights on the new ways of working with
<code>meteoland</code>.</p>
<p>If you are interested in the equivalences between older and newer
functions of <code>meteoland</code>, please see the <a href="#appendix">appendix</a> at the end of the vignette.</p>
</div>
<div class="section level3">
<h3 id="example-datasets">Example datasets<a class="anchor" aria-label="anchor" href="#example-datasets"></a>
</h3>
<p><code>meteoland</code> now ships with new example objects, based on
the <code>sf</code> and <code>stars</code> packages. The following table
describes the new data examples:</p>
<table class="table">
<colgroup>
<col width="29%">
<col width="70%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>meteoland_interpolator_example</td>
<td>A <code>meteoland</code> interpolator object, with daily
meteorological data in Catalonia (Spain) for April 2022.</td>
</tr>
<tr class="even">
<td>meteoland_meteo_example</td>
<td>Data from meteorological stations in Catalonia (Spain) for April
2022.</td>
</tr>
<tr class="odd">
<td>meteoland_meteo_no_topo_example</td>
<td>Data from meteorological stations in Catalonia (Spain) for April
2022, without topographical information.</td>
</tr>
<tr class="even">
<td>meteoland_topo_example</td>
<td>Topographical information for meteorological stations in Catalonia
(Spain).</td>
</tr>
<tr class="odd">
<td>points_to_interpolate_example</td>
<td>Topographical information for 15 plots located in Catalonia
(Spain).</td>
</tr>
<tr class="even">
<td>raster_to_interpolate_example</td>
<td>Topographical information for a 0.01 degree grid (10x10 cells)
raster located in central Catalonia (Spain)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="the-new-interpolation-process">The new interpolation process<a class="anchor" aria-label="anchor" href="#the-new-interpolation-process"></a>
</h3>
<p>The interpolation of meteorological information requires two kinds of
information:</p>
<ol style="list-style-type: decimal">
<li><p>The <strong>topographical information</strong> of the target
locations to interpolate. This includes elevation, aspect and slope.
Elevation is the only mandatory topography variable, but interpolation
results improve when also aspect and slope are provided in mountain
areas.</p></li>
<li><p>The reference <strong>meteorological information</strong> that we
will use to build the interpolator object. This information can come
from meteorological stations in the area we are interested on or,
alternatively, can be extracted from available rasters with
meteorological variables.</p></li>
</ol>
<div class="section level4">
<h4 id="topographical-information">Topographical information<a class="anchor" aria-label="anchor" href="#topographical-information"></a>
</h4>
<p>In order to interpolate, we need our locations in a format that
<code>meteoland</code> can understand. For point locations, this is a
<code>sf</code> object including the <code>elevation</code> (in
m.a.s.l.), <code>slope</code> (in degrees) and <code>aspect</code> (in
degrees) variables, such as:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">points_to_interpolate_example</span></span>
<span><span class="co">#&gt; Simple feature collection with 15 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.7578958 ymin: 41.31541 xmax: 2.98657 ymax: 42.6336</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 5</span></span></span>
<span><span class="co">#&gt;    plot_id elevation slope aspect             geometry</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P_05284      889. 25.2   313.   (2.320167 42.24139)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P_06572      680. 18.0    79.9  (2.552233 42.02596)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P_07201      141.  4.17   52.9  (2.721874 41.88258)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P_07512      254. 14.3   261.     (2.98657 41.9006)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P_08207     <span style="text-decoration: underline;">1</span>860. 36.4   293.   (2.209903 42.33968)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P_08299      183.  4.12   92.9  (2.817143 42.24325)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P_09341      819  23.4   128.   (1.126766 42.42612)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P_10272      860  34.8   347.   (1.398528 42.26791)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P_10861      706  22.4    22.6 (0.9314126 42.04226)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P_11651      585  22.0   199.   (0.7578958 41.8612)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> P_12150      674. 30.3   154.   (1.481719 41.81838)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> P_12227      752.  6.04   27.7    (1.283161 41.591)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> P_12417      702  11.6    63.1 (0.8727224 41.35875)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> P_13007      972.  4.21  338.    (1.120383 42.6336)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> P_14029      556. 14.1    41.4  (1.480716 41.31541)</span></span></code></pre></div>
<p>For spatially-continuous data (i.e. a raster), we need a
<code>stars</code> object including <code>elevation</code> (in
m.a.s.l.), <code>slope</code> (in degrees) and <code>aspect</code> (in
degrees) as attributes, such as:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raster_to_interpolate_example</span></span>
<span><span class="co">#&gt; stars object with 2 dimensions and 3 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                  Min.    1st Qu.    Median      Mean   3rd Qu.     Max.</span></span>
<span><span class="co">#&gt; elevation  240.000000 370.000000 447.00000 460.32231 525.00000 786.0000</span></span>
<span><span class="co">#&gt; slope        1.432096   5.720433  11.34812  13.07343  19.75851  31.0719</span></span>
<span><span class="co">#&gt; aspect       5.194427  74.744881 174.36932 181.67923 291.03751 360.0000</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;   from  to  offset    delta refsys x/y</span></span>
<span><span class="co">#&gt; x  155 165 0.03648  0.01058 WGS 84 [x]</span></span>
<span><span class="co">#&gt; y  110 120   42.92 -0.01058 WGS 84 [y]</span></span></code></pre></div>
<p>Both, <code>sf</code> and <code>stars</code> R packages have the
necessary functions to read most spatial formats, the only thing to
consider is ensuring that the topographical variables are included, have
the proper units and mandatory names (<code>elevation</code>,
<code>aspect</code>, <code>slope</code>).</p>
</div>
<div class="section level4">
<h4 id="meteorological-information">Meteorological information<a class="anchor" aria-label="anchor" href="#meteorological-information"></a>
</h4>
<p>For interpolating the meteorological variables in our locations (see
above), we need a reference meteorological data. This is a
<code>sf</code> object with the reference locations, and daily values of
the weather variables needed to perform the interpolation, for
example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meteoland_meteo_example</span></span>
<span><span class="co">#&gt; Simple feature collection with 5652 features and 18 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.30565 ymin: 40.55786 xmax: 3.18165 ymax: 42.77011</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,652 × 19</span></span></span>
<span><span class="co">#&gt;    dates               service stationID station_name station_province elevation</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… C6        Castellnou … Lleida                264 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… C7        Tàrrega      Lleida                427 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… C8        Cervera      Lleida                554 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… C9        Mas de Barb… Tarragona             240 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… CC        Orís         Barcelona             626 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… CD        la Seu d'Ur… Lleida                849 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… CE        els Hostale… Barcelona             316 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… CG        Molló - Fab… Girona               <span style="text-decoration: underline;">1</span>405 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… CI        Sant Pau de… Girona                852 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2022-04-01 <span style="color: #949494;">00:00:00</span> meteoc… CJ        Organyà      Lleida                566.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,642 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: MeanTemperature &lt;dbl&gt;, MinTemperature &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MaxTemperature &lt;dbl&gt;, MeanRelativeHumidity &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MinRelativeHumidity &lt;dbl&gt;, MaxRelativeHumidity &lt;dbl&gt;, Precipitation &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   WindDirection &lt;dbl&gt;, WindSpeed &lt;dbl&gt;, Radiation &lt;dbl&gt;, geom &lt;POINT [°]&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   aspect &lt;dbl&gt;, slope &lt;dbl&gt;</span></span></span></code></pre></div>
<p><code>meteoland</code> expects variable names to be as indicated in
the example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">meteoland_meteo_example</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "dates"                "service"              "stationID"           </span></span>
<span><span class="co">#&gt;  [4] "station_name"         "station_province"     "elevation"           </span></span>
<span><span class="co">#&gt;  [7] "MeanTemperature"      "MinTemperature"       "MaxTemperature"      </span></span>
<span><span class="co">#&gt; [10] "MeanRelativeHumidity" "MinRelativeHumidity"  "MaxRelativeHumidity" </span></span>
<span><span class="co">#&gt; [13] "Precipitation"        "WindDirection"        "WindSpeed"           </span></span>
<span><span class="co">#&gt; [16] "Radiation"            "geom"                 "aspect"              </span></span>
<span><span class="co">#&gt; [19] "slope"</span></span></code></pre></div>
<p>The only mandatory variables are <code>MinTemperature</code> and
<code>MaxTemperature</code>. Other variables
(<code>Precipitation</code>, <code>WindSpeed</code>…), when present,
allow for a more complete weather interpolation.</p>
<p>For more information on preparing meteorological data for
<code>meteoland</code>, see
<code><a href="../articles/reshaping-meteo.html">vignette("reshaping-meteo", package = "meteoland")</a></code></p>
</div>
<div class="section level4">
<h4 id="quick-interpolation-if-everything-is-ok">Quick interpolation (if everything is ok)<a class="anchor" aria-label="anchor" href="#quick-interpolation-if-everything-is-ok"></a>
</h4>
<p>With the necessary data in the correct format we can perform the
interpolation right away:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># creating the interpolator object</span></span>
<span><span class="va">interpolator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_meteo.html">with_meteo</a></span><span class="op">(</span><span class="va">meteoland_meteo_example</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/create_meteo_interpolator.html">create_meteo_interpolator</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Checking meteorology object...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> meteorology object ok</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Creating interpolator...</span></span>
<span><span class="co">#&gt; Warning: No interpolation parameters provided, using defaults</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Set the `params` argument to modify parameter default values</span></span>
<span><span class="co">#&gt; • Calculating smoothed variables...</span></span>
<span><span class="co">#&gt; • Updating intial_Rp parameter with the actual stations mean distance...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolator created.</span></span>
<span></span>
<span><span class="co"># performing the interpolation</span></span>
<span><span class="va">points_interpolated</span> <span class="op">&lt;-</span> <span class="va">points_to_interpolate_example</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/interpolate_data.html">interpolate_data</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting interpolation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Temperature interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating temperature...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Precipitation interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating precipitation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Relative humidity interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating relative humidity...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Radiation calculation is needed also...</span></span>
<span><span class="co">#&gt; • Calculating radiation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Wind interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating wind...</span></span>
<span><span class="co">#&gt; • Calculating PET...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolation done...</span></span>
<span><span class="va">points_interpolated</span></span>
<span><span class="co">#&gt; Simple feature collection with 15 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.7578958 ymin: 41.31541 xmax: 2.98657 ymax: 42.6336</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 6</span></span></span>
<span><span class="co">#&gt;    plot_id elevation slope aspect             geometry interpolated_data </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P_05284      889. 25.2   313.   (2.320167 42.24139) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P_06572      680. 18.0    79.9  (2.552233 42.02596) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P_07201      141.  4.17   52.9  (2.721874 41.88258) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P_07512      254. 14.3   261.     (2.98657 41.9006) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P_08207     <span style="text-decoration: underline;">1</span>860. 36.4   293.   (2.209903 42.33968) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P_08299      183.  4.12   92.9  (2.817143 42.24325) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P_09341      819  23.4   128.   (1.126766 42.42612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P_10272      860  34.8   347.   (1.398528 42.26791) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P_10861      706  22.4    22.6 (0.9314126 42.04226) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P_11651      585  22.0   199.   (0.7578958 41.8612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> P_12150      674. 30.3   154.   (1.481719 41.81838) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> P_12227      752.  6.04   27.7    (1.283161 41.591) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> P_12417      702  11.6    63.1 (0.8727224 41.35875) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> P_13007      972.  4.21  338.    (1.120383 42.6336) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> P_14029      556. 14.1    41.4  (1.480716 41.31541) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span></code></pre></div>
<p>Let’s see this step by step.</p>
<ul>
<li>
<code>with_meteo(...)</code> ensures that the provided
meteorological information is in the correct format for using it with
<code>meteoland</code>. It performs several checks and informs of any
error found. For example, if the meteorological information doesn’t have
the mandatory variables, an informative error is shown:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meteo_without_temp</span> <span class="op">&lt;-</span> <span class="va">meteoland_meteo_example</span></span>
<span><span class="va">meteo_without_temp</span><span class="op">[[</span><span class="st">"MinTemperature"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">meteo_without_temp</span><span class="op">[[</span><span class="st">"MaxTemperature"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="../reference/with_meteo.html">with_meteo</a></span><span class="op">(</span><span class="va">meteo_without_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Checking meteorology object...</span></span>
<span><span class="co">#&gt; Error: Names found in meteo don't comply with the required names:</span></span>
<span><span class="co">#&gt; meteo should have the following meteorology variables:</span></span>
<span><span class="co">#&gt;   - MinTemperature ***</span></span>
<span><span class="co">#&gt;   - MaxTemperature ***</span></span>
<span><span class="co">#&gt;   - Precipitation</span></span>
<span><span class="co">#&gt;   - RelativeHumidity</span></span>
<span><span class="co">#&gt;   - Radiation</span></span>
<span><span class="co">#&gt;   - WindSpeed</span></span>
<span><span class="co">#&gt;   - WindDirection</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ***: mandatory variables</span></span></code></pre></div>
<ul>
<li>
<code>create_meteo_interpolator(...)</code> creates the interpolator
object from the meteorological information. This object stores not only
the meteorological information, but also the parameters that will be
used in the interpolation process. These parameters can be supplied as a
list in the <code>params</code> argument from
<code><a href="../reference/create_meteo_interpolator.html">create_meteo_interpolator()</a></code> function. If not supplied, a
default set of parameters is used. At any point, we can display the
interpolation parameters using
<code><a href="../reference/get_interpolation_params.html">get_interpolation_params()</a></code>:</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parameters</span></span>
<span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span></span>
<span><span class="co">#&gt; $initial_Rp</span></span>
<span><span class="co">#&gt; [1] 1.136444</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iterations</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_MaxTemperature</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_DewTemperature</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_PrecipitationEvent</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_PrecipitationAmount</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_Wind</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_MaxTemperature</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_DewTemperature</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_PrecipitationEvent</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_PrecipitationAmount</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_Wind</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $St_Precipitation</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $St_TemperatureRange</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_crit</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f_max</span></span>
<span><span class="co">#&gt; [1] 0.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wind_height</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wind_roughness_height</span></span>
<span><span class="co">#&gt; [1] 0.001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $penman_albedo</span></span>
<span><span class="co">#&gt; [1] 0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $penman_windfun</span></span>
<span><span class="co">#&gt; [1] "1956"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $debug</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<ul>
<li>
<code>interpolate_data(...)</code> performs the interpolation using
the topography provided and the interpolator object. If the
topographical information is in an <code>sf</code> object, as in the
example above, <code>interpolate_data</code> returns the same
<code>sf</code> object with an additional column called
<code>interpolated_data</code>:</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># interpolated meteo for the first location</span></span>
<span><span class="va">points_interpolated</span><span class="op">[[</span><span class="st">"interpolated_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 13</span></span></span>
<span><span class="co">#&gt;    dates                 DOY MeanTemperature MinTemperature MaxTemperature</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2022-04-01 <span style="color: #949494;">00:00:00</span>    91            3.24          -<span style="color: #BB0000;">2.53</span>           6.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2022-04-02 <span style="color: #949494;">00:00:00</span>    92            2.99          -<span style="color: #BB0000;">4.20</span>           7.67</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2022-04-03 <span style="color: #949494;">00:00:00</span>    93            2.39          -<span style="color: #BB0000;">5.61</span>           7.59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2022-04-04 <span style="color: #949494;">00:00:00</span>    94            4.02          -<span style="color: #BB0000;">3.93</span>           9.20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2022-04-05 <span style="color: #949494;">00:00:00</span>    95            7.38          -<span style="color: #BB0000;">3.29</span>          14.3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2022-04-06 <span style="color: #949494;">00:00:00</span>    96            8.78           1.31          13.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2022-04-07 <span style="color: #949494;">00:00:00</span>    97           12.1            2.44          18.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2022-04-08 <span style="color: #949494;">00:00:00</span>    98           12.9            3.32          19.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2022-04-09 <span style="color: #949494;">00:00:00</span>    99           10.0            3.83          14.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2022-04-10 <span style="color: #949494;">00:00:00</span>   100           11.4            4.85          15.6 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: Precipitation &lt;dbl&gt;, MeanRelativeHumidity &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MinRelativeHumidity &lt;dbl&gt;, MaxRelativeHumidity &lt;dbl&gt;, Radiation &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   WindSpeed &lt;dbl&gt;, WindDirection &lt;dbl&gt;, PET &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We can “unnest” the results to get the data in a <em>long</em> format
(each combination of location and date in a different row):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">points_interpolated</span>, cols <span class="op">=</span> <span class="st">"interpolated_data"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 450 features and 17 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.7578958 ymin: 41.31541 xmax: 2.98657 ymax: 42.6336</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 450 × 18</span></span></span>
<span><span class="co">#&gt;    plot_id elevation slope aspect            geometry dates              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-01 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-02 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-03 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-04 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-05 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-06 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-07 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-08 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-09 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P_05284      889.  25.2   313. (2.320167 42.24139) 2022-04-10 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 440 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 12 more variables: DOY &lt;dbl&gt;, MeanTemperature &lt;dbl&gt;, MinTemperature &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MaxTemperature &lt;dbl&gt;, Precipitation &lt;dbl&gt;, MeanRelativeHumidity &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MinRelativeHumidity &lt;dbl&gt;, MaxRelativeHumidity &lt;dbl&gt;, Radiation &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   WindSpeed &lt;dbl&gt;, WindDirection &lt;dbl&gt;, PET &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="interpolator-object">Interpolator object<a class="anchor" aria-label="anchor" href="#interpolator-object"></a>
</h3>
<p>In older versions of meteoland, the interpolator object inherited the
<code>MeteorologyInterpolationData</code> class (based on
<code>sp</code> classes). Starting on <code>meteoland v2.0.0</code>,
<code>MeteorologyInterpolationData</code> class is deprecated, and the
interpolator object created by <code><a href="../reference/create_meteo_interpolator.html">create_meteo_interpolator()</a></code>
inherits directly from <code>stars</code> class.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "stars"</span></span></code></pre></div>
<p>This object is a data cube, with reference weather locations and
dates as dimensions, and meteorological and topographical variables as
attributes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interpolator</span></span>
<span><span class="co">#&gt; stars object with 2 dimensions and 13 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                                 Min.    1st Qu.    Median       Mean   3rd Qu.</span></span>
<span><span class="co">#&gt; Temperature               -14.200000   8.800000  12.60000  11.324991  14.80000</span></span>
<span><span class="co">#&gt; MinTemperature            -15.900000   3.300000   6.90000   5.883189   9.40000</span></span>
<span><span class="co">#&gt; MaxTemperature            -13.000000  13.900000  18.30000  17.364292  21.80000</span></span>
<span><span class="co">#&gt; RelativeHumidity           18.000000  57.000000  67.00000  67.720000  78.00000</span></span>
<span><span class="co">#&gt; Precipitation               0.000000   0.000000   0.00000   1.925434   0.10000</span></span>
<span><span class="co">#&gt; Radiation                   7.707484  17.717235  22.04597  20.762628  23.61352</span></span>
<span><span class="co">#&gt; WindDirection               0.000000 116.000000 217.00000 196.861908 275.00000</span></span>
<span><span class="co">#&gt; WindSpeed                   0.200000   0.900000   1.30000   1.603907   2.00000</span></span>
<span><span class="co">#&gt; elevation                   0.000000 147.000000 317.00000 515.629630 668.00000</span></span>
<span><span class="co">#&gt; aspect                      0.000000   0.000000   0.00000   0.000000   0.00000</span></span>
<span><span class="co">#&gt; slope                       0.000000   0.000000   0.00000   0.000000   0.00000</span></span>
<span><span class="co">#&gt; SmoothedPrecipitation       0.100000   1.862500   5.55000   6.197496   9.07500</span></span>
<span><span class="co">#&gt; SmoothedTemperatureRange    4.695000   9.863542  11.66307  11.400932  13.26868</span></span>
<span><span class="co">#&gt;                                 Max. NA's</span></span>
<span><span class="co">#&gt; Temperature                 23.40000  148</span></span>
<span><span class="co">#&gt; MinTemperature              20.10000  138</span></span>
<span><span class="co">#&gt; MaxTemperature              29.90000  139</span></span>
<span><span class="co">#&gt; RelativeHumidity           100.00000  145</span></span>
<span><span class="co">#&gt; Precipitation              160.90000   79</span></span>
<span><span class="co">#&gt; Radiation                   28.10878  139</span></span>
<span><span class="co">#&gt; WindDirection              359.00000 4171</span></span>
<span><span class="co">#&gt; WindSpeed                    6.90000 4160</span></span>
<span><span class="co">#&gt; elevation                 2535.00000    0</span></span>
<span><span class="co">#&gt; aspect                       0.00000    0</span></span>
<span><span class="co">#&gt; slope                        0.00000    0</span></span>
<span><span class="co">#&gt; SmoothedPrecipitation       65.10000  818</span></span>
<span><span class="co">#&gt; SmoothedTemperatureRange    17.72778  124</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;         from  to         offset  delta  refsys point</span></span>
<span><span class="co">#&gt; date       1  30 2022-04-01 UTC 1 days POSIXct FALSE</span></span>
<span><span class="co">#&gt; station    1 189             NA     NA  WGS 84  TRUE</span></span>
<span><span class="co">#&gt;                                                       values</span></span>
<span><span class="co">#&gt; date                                                    NULL</span></span>
<span><span class="co">#&gt; station POINT (0.95172 41.6566),...,POINT (1.89716 42.32211)</span></span></code></pre></div>
<p>The object also contains the interpolation parameters as an
attribute, that can be accessed with
<code><a href="../reference/get_interpolation_params.html">get_interpolation_params()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span></span>
<span><span class="co">#&gt; $initial_Rp</span></span>
<span><span class="co">#&gt; [1] 1.136444</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iterations</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_MaxTemperature</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_DewTemperature</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_PrecipitationEvent</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_PrecipitationAmount</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_Wind</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_MaxTemperature</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_DewTemperature</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_PrecipitationEvent</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_PrecipitationAmount</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $N_Wind</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $St_Precipitation</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $St_TemperatureRange</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pop_crit</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f_max</span></span>
<span><span class="co">#&gt; [1] 0.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wind_height</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wind_roughness_height</span></span>
<span><span class="co">#&gt; [1] 0.001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $penman_albedo</span></span>
<span><span class="co">#&gt; [1] 0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $penman_windfun</span></span>
<span><span class="co">#&gt; [1] "1956"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $debug</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Interpolation parameters can also be changed with
<code><a href="../reference/set_interpolation_params.html">set_interpolation_params()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># wind_height parameter</span></span>
<span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span><span class="op">$</span><span class="va">wind_height</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span></span>
<span><span class="co"># set a new wind_height parameter and check</span></span>
<span><span class="va">interpolator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_interpolation_params.html">set_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wind_height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Some interpolation parameters are missing, using default values for those</span></span>
<span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span><span class="op">$</span><span class="va">wind_height</span></span>
<span><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<div class="section level4">
<h4 id="writing-and-reading-interpolator-objects">Writing and reading interpolator objects<a class="anchor" aria-label="anchor" href="#writing-and-reading-interpolator-objects"></a>
</h4>
<p>Interpolator objects can be reused for different interpolations
exercises within the area covered by the interpolator. To allow
interpolator objects to be shared between sessions,
<code>meteoland</code> offers functions to write and read these objects.
The interpolator is saved in NetCDF-CF format (<a href="https://cfconventions.org/cf-conventions/cf-conventions.html" class="external-link uri">https://cfconventions.org/cf-conventions/cf-conventions.html</a>)
and can be also opened with any GIS software that supports
NetCDF-CF.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temporal_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_interpolator.html">write_interpolator</a></span><span class="op">(</span><span class="va">interpolator</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temporal_folder</span>, <span class="st">"interpolator.nc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Creating nc file following the NetCDF-CF conventions <span style="color: #0000BB; font-style: italic;">&lt;https://cfconventions.org/cf-conventions/cf-conventions.html&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding spatial info to nc file</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Done</span></span>
<span><span class="co"># file should exists now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temporal_folder</span>, <span class="st">"interpolator.nc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>To load the interpolator in your session again, you can use the
<code><a href="../reference/read_interpolator.html">read_interpolator()</a></code> function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file_interpolator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_interpolator.html">read_interpolator</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temporal_folder</span>, <span class="st">"interpolator.nc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># the read interpolator should be identical to the one we have already</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">file_interpolator</span>, <span class="va">interpolator</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="interpolator-calibration">Interpolator calibration<a class="anchor" aria-label="anchor" href="#interpolator-calibration"></a>
</h4>
<p>Interpolation parameters can be calibrated for individual variables
before performing the interpolation process. In fact, <strong>it’s
recommended</strong> to calibrate the interpolator object before using
it, as the default interpolation parameters can be not adequate for the
studied area. <code>meteoland</code> offers a calibration process with
the <code><a href="../reference/interpolator_calibration.html">interpolator_calibration()</a></code> function.</p>
<pre><code>**Important!** Calibration process for one variable can take a long time to finish,
as it performs a *leave-one-out* interpolation for all stations present in the
interpolator and all combinations of N and alpha sequences provided. In this example
we reduce the N and alpha test values for the process to be faster, but is recommended
to explore a wider range of these values.</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># min temperature N and alpha before calibration</span></span>
<span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span><span class="op">$</span><span class="va">N_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span><span class="op">$</span><span class="va">alpha_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span></span>
<span><span class="co"># calibration</span></span>
<span><span class="va">interpolator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolator_calibration.html">interpolator_calibration</a></span><span class="op">(</span></span>
<span>  <span class="va">interpolator</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"MinTemperature"</span>,</span>
<span>  N_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  alpha_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  update_interpolation_params <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Total number of stations: <span style="color: #0000BB;">189</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations with available data: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations used for MAE calculation: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of parameters combinations to test: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting evaluation of parameter combinations for <span style="color: #0000BB;">"MinTemperature"</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Calibration done: Minimum MAE: <span style="color: #0000BB;">1.18956628899488</span>; N: <span style="color: #0000BB;">20</span>; alpha: <span style="color: #0000BB;">10</span></span></span>
<span></span>
<span><span class="co"># parameters after calibration</span></span>
<span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span><span class="op">$</span><span class="va">N_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="fu"><a href="../reference/get_interpolation_params.html">get_interpolation_params</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span><span class="op">$</span><span class="va">alpha_MinTemperature</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>One advantage of the new data flows in <code>meteoland</code> is that
we can <em>pipe</em> the creation and the calibration of the
interpolator, as well as the writing:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interpolator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_meteo.html">with_meteo</a></span><span class="op">(</span><span class="va">meteoland_meteo_example</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/create_meteo_interpolator.html">create_meteo_interpolator</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/interpolator_calibration.html">interpolator_calibration</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"MinTemperature"</span>,</span>
<span>    N_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>    alpha_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    update_interpolation_params <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/interpolator_calibration.html">interpolator_calibration</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"MaxTemperature"</span>,</span>
<span>    N_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>    alpha_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    update_interpolation_params <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/interpolator_calibration.html">interpolator_calibration</a></span><span class="op">(</span></span>
<span>    variable <span class="op">=</span> <span class="st">"DewTemperature"</span>,</span>
<span>    N_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>    alpha_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    update_interpolation_params <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_interpolator.html">write_interpolator</a></span><span class="op">(</span></span>
<span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temporal_folder</span>, <span class="st">"interpolator.nc"</span><span class="op">)</span>,</span>
<span>    .overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Checking meteorology object...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> meteorology object ok</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Creating interpolator...</span></span>
<span><span class="co">#&gt; Warning: No interpolation parameters provided, using defaults</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Set the `params` argument to modify parameter default values</span></span>
<span><span class="co">#&gt; • Calculating smoothed variables...</span></span>
<span><span class="co">#&gt; • Updating intial_Rp parameter with the actual stations mean distance...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolator created.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Total number of stations: <span style="color: #0000BB;">189</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations with available data: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations used for MAE calculation: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of parameters combinations to test: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting evaluation of parameter combinations for <span style="color: #0000BB;">"MinTemperature"</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Calibration done: Minimum MAE: <span style="color: #0000BB;">1.18956628899488</span>; N: <span style="color: #0000BB;">20</span>; alpha: <span style="color: #0000BB;">10</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Total number of stations: <span style="color: #0000BB;">189</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations with available data: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations used for MAE calculation: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of parameters combinations to test: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting evaluation of parameter combinations for <span style="color: #0000BB;">"MaxTemperature"</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Calibration done: Minimum MAE: <span style="color: #0000BB;">0.849019890784243</span>; N: <span style="color: #0000BB;">20</span>; alpha: <span style="color: #0000BB;">10</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Total number of stations: <span style="color: #0000BB;">189</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations with available data: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of stations used for MAE calculation: <span style="color: #0000BB;">185</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Number of parameters combinations to test: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting evaluation of parameter combinations for <span style="color: #0000BB;">"DewTemperature"</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">5</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">1</span>...</span></span>
<span><span class="co">#&gt; • Evaluating N: <span style="color: #0000BB;">20</span>, alpha: <span style="color: #0000BB;">10</span>...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Calibration done: Minimum MAE: <span style="color: #0000BB;">1.37971537117584</span>; N: <span style="color: #0000BB;">20</span>; alpha: <span style="color: #0000BB;">10</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Creating nc file following the NetCDF-CF conventions <span style="color: #0000BB; font-style: italic;">&lt;https://cfconventions.org/cf-conventions/cf-conventions.html&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding spatial info to nc file</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Done</span></span></code></pre></div>
<p>This way we can create and calibrate the interpolator once, and using
it in future sessions, avoiding the time consuming step of calibrating
every time.</p>
</div>
</div>
<div class="section level3">
<h3 id="interpolation-validation">Interpolation validation<a class="anchor" aria-label="anchor" href="#interpolation-validation"></a>
</h3>
<p>The interpolation process can be cross validated.
<code>meteoland</code> offers the possibility with the
<code><a href="../reference/interpolator_calibration.html">interpolation_cross_validation()</a></code> function. This function
takes an interpolator object and calculates different error
measures.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cross_validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolator_calibration.html">interpolation_cross_validation</a></span><span class="op">(</span><span class="va">interpolator</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cross_validation</span><span class="op">$</span><span class="va">errors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,670 × 21</span></span></span>
<span><span class="co">#&gt;    dates               station stationID MinTemperature_error</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2022-04-01 <span style="color: #949494;">00:00:00</span>       1 C6                      0.125 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2022-04-02 <span style="color: #949494;">00:00:00</span>       1 C6                      0.059<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2022-04-03 <span style="color: #949494;">00:00:00</span>       1 C6                      0.145 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2022-04-04 <span style="color: #949494;">00:00:00</span>       1 C6                     -<span style="color: #BB0000;">0.306</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2022-04-05 <span style="color: #949494;">00:00:00</span>       1 C6                     -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2022-04-06 <span style="color: #949494;">00:00:00</span>       1 C6                     -<span style="color: #BB0000;">0.248</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2022-04-07 <span style="color: #949494;">00:00:00</span>       1 C6                     -<span style="color: #BB0000;">0.457</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2022-04-08 <span style="color: #949494;">00:00:00</span>       1 C6                      1.24  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2022-04-09 <span style="color: #949494;">00:00:00</span>       1 C6                     -<span style="color: #BB0000;">0.546</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2022-04-10 <span style="color: #949494;">00:00:00</span>       1 C6                      0.601 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,660 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more variables: MaxTemperature_error &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   RangeTemperature_error &lt;dbl&gt;, RelativeHumidity_error &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Radiation_error &lt;dbl&gt;, Precipitation_error &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MinTemperature_predicted &lt;dbl&gt;, MaxTemperature_predicted &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   RangeTemperature_predicted &lt;dbl&gt;, RelativeHumidity_predicted &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Radiation_predicted &lt;dbl&gt;, Precipitation_predicted &lt;dbl&gt;, …</span></span></span>
<span><span class="va">cross_validation</span><span class="op">$</span><span class="va">station_stats</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 189 × 20</span></span></span>
<span><span class="co">#&gt;    station stationID MinTemperature_station_bias MaxTemperature_station_bias</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 C6                            -<span style="color: #BB0000;">0.109</span>                     -<span style="color: #BB0000;">0.606</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2 C7                            -<span style="color: #BB0000;">1.03</span>                      -<span style="color: #BB0000;">0.582</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3 C8                             0.018<span style="text-decoration: underline;">0</span>                     0.035<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4 C9                            -<span style="color: #BB0000;">0.316</span>                      0.657  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5 CC                            -<span style="color: #BB0000;">0.037</span><span style="color: #BB0000; text-decoration: underline;">3</span>                    -<span style="color: #BB0000;">0.483</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6 CD                             0.508                     -<span style="color: #BB0000;">1.03</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7 CE                            -<span style="color: #BB0000;">1.62</span>                      -<span style="color: #BB0000;">0.779</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8 CG                            -<span style="color: #BB0000;">1.51</span>                      -<span style="color: #BB0000;">0.379</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9 CI                             0.888                      0.509  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10 CJ                             0.572                      0.005<span style="text-decoration: underline;">25</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 179 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more variables: RangeTemperature_station_bias &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   RelativeHumidity_station_bias &lt;dbl&gt;, Radiation_station_bias &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MinTemperature_station_mae &lt;dbl&gt;, MaxTemperature_station_mae &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   RangeTemperature_station_mae &lt;dbl&gt;, RelativeHumidity_station_mae &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Radiation_station_mae &lt;dbl&gt;, TotalPrecipitation_station_observed &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   TotalPrecipitation_station_predicted &lt;dbl&gt;, …</span></span></span>
<span><span class="va">cross_validation</span><span class="op">$</span><span class="va">dates_stats</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 19</span></span></span>
<span><span class="co">#&gt;    dates               MinTemperature_date_bias MaxTemperature_date_bias</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2022-04-01 <span style="color: #949494;">00:00:00</span>                   0.012<span style="text-decoration: underline;">5</span>                   0.040<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2022-04-02 <span style="color: #949494;">00:00:00</span>                   0.032<span style="text-decoration: underline;">9</span>                   0.097<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2022-04-03 <span style="color: #949494;">00:00:00</span>                  -<span style="color: #BB0000;">0.116</span>                    0.032<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2022-04-04 <span style="color: #949494;">00:00:00</span>                  -<span style="color: #BB0000;">0.142</span>                    0.040<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2022-04-05 <span style="color: #949494;">00:00:00</span>                  -<span style="color: #BB0000;">0.185</span>                    0.078<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2022-04-06 <span style="color: #949494;">00:00:00</span>                  -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">3</span>                   0.068<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2022-04-07 <span style="color: #949494;">00:00:00</span>                  -<span style="color: #BB0000;">0.156</span>                    0.107 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2022-04-08 <span style="color: #949494;">00:00:00</span>                  -<span style="color: #BB0000;">0.058</span><span style="color: #BB0000; text-decoration: underline;">2</span>                   0.060<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2022-04-09 <span style="color: #949494;">00:00:00</span>                   0.080<span style="text-decoration: underline;">1</span>                   0.047<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2022-04-10 <span style="color: #949494;">00:00:00</span>                  -<span style="color: #BB0000;">0.101</span>                    0.076<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more variables: RangeTemperature_date_bias &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   RelativeHumidity_date_bias &lt;dbl&gt;, Radiation_date_bias &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   MinTemperature_date_mae &lt;dbl&gt;, MaxTemperature_date_mae &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   RangeTemperature_date_mae &lt;dbl&gt;, RelativeHumidity_date_mae &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Radiation_date_mae &lt;dbl&gt;, TotalPrecipitation_date_observed &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   TotalPrecipitation_date_predicted &lt;dbl&gt;, …</span></span></span>
<span><span class="va">cross_validation</span><span class="op">$</span><span class="va">r2</span></span>
<span><span class="co">#&gt; $MinTemperature</span></span>
<span><span class="co">#&gt; [1] 0.9388959</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MaxTemperature</span></span>
<span><span class="co">#&gt; [1] 0.9788855</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RangeTemperature</span></span>
<span><span class="co">#&gt; [1] 0.8835377</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RelativeHumidity</span></span>
<span><span class="co">#&gt; [1] 0.8096727</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Radiation</span></span>
<span><span class="co">#&gt; [1] 0.8911309</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpolation-utils">Interpolation utils<a class="anchor" aria-label="anchor" href="#interpolation-utils"></a>
</h3>
<p><code>meteoland</code> also offers some utilities to work with the
interpolated data.</p>
<div class="section level4">
<h4 id="temporal-summary-of-interpolated-data">Temporal summary of interpolated data<a class="anchor" aria-label="anchor" href="#temporal-summary-of-interpolated-data"></a>
</h4>
<p><code>meteoland</code> works at the daily scale. But sometimes the
data needs to be aggregated into bigger temporal scales (monthly,
quarterly, yearly…). This can be done with the
<code><a href="../reference/summarise_interpolated_data.html">summarise_interpolated_data()</a></code> function. This function takes
the result of <code>interpolate_data</code> and creates summaries in the
desired frequency.<br>
The function returns the same interpolated data given as input, but with
the weekly summary in an additional column.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarise_interpolated_data.html">summarise_interpolated_data</a></span><span class="op">(</span></span>
<span>  <span class="va">points_interpolated</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"week"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 15 features and 6 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.7578958 ymin: 41.31541 xmax: 2.98657 ymax: 42.6336</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 7</span></span></span>
<span><span class="co">#&gt;    plot_id elevation slope aspect             geometry interpolated_data </span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P_05284      889. 25.2   313.   (2.320167 42.24139) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P_06572      680. 18.0    79.9  (2.552233 42.02596) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P_07201      141.  4.17   52.9  (2.721874 41.88258) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P_07512      254. 14.3   261.     (2.98657 41.9006) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P_08207     <span style="text-decoration: underline;">1</span>860. 36.4   293.   (2.209903 42.33968) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P_08299      183.  4.12   92.9  (2.817143 42.24325) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P_09341      819  23.4   128.   (1.126766 42.42612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P_10272      860  34.8   347.   (1.398528 42.26791) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P_10861      706  22.4    22.6 (0.9314126 42.04226) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P_11651      585  22.0   199.   (0.7578958 41.8612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> P_12150      674. 30.3   154.   (1.481719 41.81838) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> P_12227      752.  6.04   27.7    (1.283161 41.591) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> P_12417      702  11.6    63.1 (0.8727224 41.35875) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> P_13007      972.  4.21  338.    (1.120383 42.6336) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> P_14029      556. 14.1    41.4  (1.480716 41.31541) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: weekly_mean &lt;list&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="calculating-rainfall-erosivity">Calculating rainfall erosivity<a class="anchor" aria-label="anchor" href="#calculating-rainfall-erosivity"></a>
</h4>
<p><code>meteoland</code> also offers the possibility of calculating the
rainfall erosivity value, with the
<code><a href="../reference/precipitation_rainfall_erosivity.html">precipitation_rainfall_erosivity()</a></code> function. This can be
used for individual locations:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/precipitation_rainfall_erosivity.html">precipitation_rainfall_erosivity</a></span><span class="op">(</span></span>
<span>  <span class="va">points_interpolated</span><span class="op">$</span><span class="va">interpolated_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  longitude <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">points_interpolated</span><span class="op">$</span><span class="va">geometry</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">'month'</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;        4 </span></span>
<span><span class="co">#&gt; 48.02896</span></span></code></pre></div>
<p>But also for all locations in the results obtained from the call to
<code><a href="../reference/interpolate_data.html">interpolate_data()</a></code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">points_interpolated</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>erosivity <span class="op">=</span> <span class="fu"><a href="../reference/precipitation_rainfall_erosivity.html">precipitation_rainfall_erosivity</a></span><span class="op">(</span></span>
<span>    <span class="va">interpolated_data</span>,</span>
<span>    longitude <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>    scale <span class="op">=</span> <span class="st">'month'</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 15 features and 6 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.7578958 ymin: 41.31541 xmax: 2.98657 ymax: 42.6336</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 7</span></span></span>
<span><span class="co">#&gt;    plot_id elevation slope aspect             geometry interpolated_data </span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P_05284      889. 25.2   313.   (2.320167 42.24139) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P_06572      680. 18.0    79.9  (2.552233 42.02596) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P_07201      141.  4.17   52.9  (2.721874 41.88258) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P_07512      254. 14.3   261.     (2.98657 41.9006) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P_08207     <span style="text-decoration: underline;">1</span>860. 36.4   293.   (2.209903 42.33968) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P_08299      183.  4.12   92.9  (2.817143 42.24325) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P_09341      819  23.4   128.   (1.126766 42.42612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P_10272      860  34.8   347.   (1.398528 42.26791) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P_10861      706  22.4    22.6 (0.9314126 42.04226) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P_11651      585  22.0   199.   (0.7578958 41.8612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> P_12150      674. 30.3   154.   (1.481719 41.81838) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> P_12227      752.  6.04   27.7    (1.283161 41.591) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> P_12417      702  11.6    63.1 (0.8727224 41.35875) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> P_13007      972.  4.21  338.    (1.120383 42.6336) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> P_14029      556. 14.1    41.4  (1.480716 41.31541) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: erosivity &lt;list&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="piping-all-together">Piping all together<a class="anchor" aria-label="anchor" href="#piping-all-together"></a>
</h4>
<p><code>meteoland</code> new data flows also allows for piping all
processes:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">points_interpolated</span> <span class="op">&lt;-</span> <span class="va">points_to_interpolate_example</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/interpolate_data.html">interpolate_data</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summarise_interpolated_data.html">summarise_interpolated_data</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>    frequency <span class="op">=</span> <span class="st">"week"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summarise_interpolated_data.html">summarise_interpolated_data</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>    frequency <span class="op">=</span> <span class="st">"month"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    monthly_erosivity <span class="op">=</span> <span class="fu"><a href="../reference/precipitation_rainfall_erosivity.html">precipitation_rainfall_erosivity</a></span><span class="op">(</span></span>
<span>      <span class="va">interpolated_data</span>,</span>
<span>      longitude <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>      scale <span class="op">=</span> <span class="st">'month'</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting interpolation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Temperature interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating temperature...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Precipitation interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating precipitation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Relative humidity interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating relative humidity...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Radiation calculation is needed also...</span></span>
<span><span class="co">#&gt; • Calculating radiation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Wind interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating wind...</span></span>
<span><span class="co">#&gt; • Calculating PET...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolation done...</span></span>
<span></span>
<span><span class="va">points_interpolated</span></span>
<span><span class="co">#&gt; Simple feature collection with 15 features and 8 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.7578958 ymin: 41.31541 xmax: 2.98657 ymax: 42.6336</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 9</span></span></span>
<span><span class="co">#&gt;    plot_id elevation slope aspect             geometry interpolated_data </span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P_05284      889. 25.2   313.   (2.320167 42.24139) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P_06572      680. 18.0    79.9  (2.552233 42.02596) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P_07201      141.  4.17   52.9  (2.721874 41.88258) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P_07512      254. 14.3   261.     (2.98657 41.9006) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P_08207     <span style="text-decoration: underline;">1</span>860. 36.4   293.   (2.209903 42.33968) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P_08299      183.  4.12   92.9  (2.817143 42.24325) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P_09341      819  23.4   128.   (1.126766 42.42612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P_10272      860  34.8   347.   (1.398528 42.26791) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P_10861      706  22.4    22.6 (0.9314126 42.04226) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P_11651      585  22.0   199.   (0.7578958 41.8612) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> P_12150      674. 30.3   154.   (1.481719 41.81838) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> P_12227      752.  6.04   27.7    (1.283161 41.591) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> P_12417      702  11.6    63.1 (0.8727224 41.35875) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> P_13007      972.  4.21  338.    (1.120383 42.6336) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> P_14029      556. 14.1    41.4  (1.480716 41.31541) <span style="color: #949494;">&lt;tibble [30 × 13]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: weekly_mean &lt;list&gt;, monthly_max &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   monthly_erosivity &lt;list&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="interpolation-on-raster-data">Interpolation on raster data<a class="anchor" aria-label="anchor" href="#interpolation-on-raster-data"></a>
</h3>
<p>We can use the <code><a href="../reference/interpolate_data.html">interpolate_data()</a></code> function in a raster
type of data. All we need in this case is the topography information in
a <code>stars</code> object, with <code>elevation</code>,
<code>aspect</code> and <code>slope</code> variables as raster
attributes:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raster_to_interpolate_example</span></span>
<span><span class="co">#&gt; stars object with 2 dimensions and 3 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                  Min.    1st Qu.    Median      Mean   3rd Qu.     Max.</span></span>
<span><span class="co">#&gt; elevation  240.000000 370.000000 447.00000 460.32231 525.00000 786.0000</span></span>
<span><span class="co">#&gt; slope        1.432096   5.720433  11.34812  13.07343  19.75851  31.0719</span></span>
<span><span class="co">#&gt; aspect       5.194427  74.744881 174.36932 181.67923 291.03751 360.0000</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;   from  to  offset    delta refsys x/y</span></span>
<span><span class="co">#&gt; x  155 165 0.03648  0.01058 WGS 84 [x]</span></span>
<span><span class="co">#&gt; y  110 120   42.92 -0.01058 WGS 84 [y]</span></span></code></pre></div>
<p>In this case, the raster is a 0.01 degree grid (10x10 cells) in
central Catalonia. As the raster is inside the area covered by the
interpolator object we created before, we will use it.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raster_interpolated</span> <span class="op">&lt;-</span> <span class="va">raster_to_interpolate_example</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/interpolate_data.html">interpolate_data</a></span><span class="op">(</span><span class="va">interpolator</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting interpolation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Temperature interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating temperature...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Precipitation interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating precipitation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Relative humidity interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating relative humidity...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Radiation calculation is needed also...</span></span>
<span><span class="co">#&gt; • Calculating radiation...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Wind interpolation is needed also...</span></span>
<span><span class="co">#&gt; • Interpolating wind...</span></span>
<span><span class="co">#&gt; • Calculating PET...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolation done...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Binding together interpolation results</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolation process finished</span></span>
<span></span>
<span><span class="va">raster_interpolated</span></span>
<span><span class="co">#&gt; stars object with 3 dimensions and 14 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                               Min.     1st Qu.     Median       Mean</span></span>
<span><span class="co">#&gt; MeanTemperature         3.28710017  11.4127317  13.905175  13.419200</span></span>
<span><span class="co">#&gt; MinTemperature         -4.21944950   3.9207208   6.575382   5.306937</span></span>
<span><span class="co">#&gt; MaxTemperature          6.96679206  14.9159502  19.225056  18.693510</span></span>
<span><span class="co">#&gt; Precipitation           0.00000000   0.0000000   0.000000   1.217155</span></span>
<span><span class="co">#&gt; MeanRelativeHumidity   32.89385498  58.0844689  64.649229  65.957527</span></span>
<span><span class="co">#&gt; MinRelativeHumidity    25.19625829  38.4317461  44.433889  47.943580</span></span>
<span><span class="co">#&gt; MaxRelativeHumidity    49.75939189 100.0000000 100.000000  97.027820</span></span>
<span><span class="co">#&gt; Radiation               7.38449673  16.1504318  20.815039  19.742938</span></span>
<span><span class="co">#&gt; WindSpeed               0.02164994   0.9119314   1.252240   1.385929</span></span>
<span><span class="co">#&gt; WindDirection           0.18621266  71.4293342 198.955399 181.615512</span></span>
<span><span class="co">#&gt; PET                     1.09428184   2.4611166   3.196850   3.110504</span></span>
<span><span class="co">#&gt; elevation             240.00000000 370.0000000 447.000000 460.322314</span></span>
<span><span class="co">#&gt; slope                   1.43209624   5.7204332  11.348120  13.073426</span></span>
<span><span class="co">#&gt; aspect                  5.19442749  74.7448807 174.369324 181.679232</span></span>
<span><span class="co">#&gt;                           3rd Qu.       Max. NA's</span></span>
<span><span class="co">#&gt; MeanTemperature        16.0215966  20.225457    0</span></span>
<span><span class="co">#&gt; MinTemperature          7.6128811  11.721902    0</span></span>
<span><span class="co">#&gt; MaxTemperature         22.3273620  29.104431    0</span></span>
<span><span class="co">#&gt; Precipitation           0.2922964  21.000409    0</span></span>
<span><span class="co">#&gt; MeanRelativeHumidity   75.6627580 100.000000    0</span></span>
<span><span class="co">#&gt; MinRelativeHumidity    55.1586632  91.663163    0</span></span>
<span><span class="co">#&gt; MaxRelativeHumidity   100.0000000 100.000000    0</span></span>
<span><span class="co">#&gt; Radiation              23.8148915  28.126824    0</span></span>
<span><span class="co">#&gt; WindSpeed               1.7444530   5.811866   30</span></span>
<span><span class="co">#&gt; WindDirection         264.0404014 359.908196 1350</span></span>
<span><span class="co">#&gt; PET                     3.7822172   5.598250    0</span></span>
<span><span class="co">#&gt; elevation             525.0000000 786.000000    0</span></span>
<span><span class="co">#&gt; slope                  19.7585106  31.071896    0</span></span>
<span><span class="co">#&gt; aspect                291.0375061 360.000000    0</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;      from to         offset    delta  refsys point x/y</span></span>
<span><span class="co">#&gt; x       1 11          1.671  0.01058  WGS 84 FALSE [x]</span></span>
<span><span class="co">#&gt; y       1 11          41.76 -0.01058  WGS 84 FALSE [y]</span></span>
<span><span class="co">#&gt; date    1 30 2022-04-01 UTC   1 days POSIXct FALSE</span></span></code></pre></div>
<p>As we can see, the returned object is the same <code>stars</code>
raster provided to the function, with the interpolated meteorological
variables as new attributes. Dimensions now include the date, besides
the input’s latitude and longitude.</p>
<div class="section level4">
<h4 id="temporal-aggregation-in-raster">Temporal aggregation in raster<a class="anchor" aria-label="anchor" href="#temporal-aggregation-in-raster"></a>
</h4>
<p>Like with the point location example, interpolated data in raster
format can also be aggregated temporally.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarise_interpolated_data.html">summarise_interpolated_data</a></span><span class="op">(</span></span>
<span>  <span class="va">raster_interpolated</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"week"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; stars object with 3 dimensions and 11 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                              Min.      1st Qu.     Median       Mean</span></span>
<span><span class="co">#&gt; MeanTemperature         3.8085157  11.46543487  13.276586  12.702695</span></span>
<span><span class="co">#&gt; MinTemperature         -2.1490631   2.77153554   6.299540   4.640385</span></span>
<span><span class="co">#&gt; MaxTemperature          7.6274425  16.18746065  18.457836  17.944528</span></span>
<span><span class="co">#&gt; Precipitation           0.0000000   0.04039901   0.372891   1.068806</span></span>
<span><span class="co">#&gt; MeanRelativeHumidity   42.9062182  60.53136706  64.595298  63.904152</span></span>
<span><span class="co">#&gt; MinRelativeHumidity    29.2592761  40.80836041  45.249846  46.333339</span></span>
<span><span class="co">#&gt; MaxRelativeHumidity    75.1187263  96.67327485  99.376895  95.009647</span></span>
<span><span class="co">#&gt; Radiation              11.7245475  17.90842114  19.929736  19.765548</span></span>
<span><span class="co">#&gt; WindSpeed               0.6861051   0.87245304   1.343451   1.515442</span></span>
<span><span class="co">#&gt; WindDirection         122.7681189 152.95041467 168.597605 184.990642</span></span>
<span><span class="co">#&gt; PET                     1.6176152   2.74501755   3.084015   3.091572</span></span>
<span><span class="co">#&gt;                           3rd Qu.       Max. NA's</span></span>
<span><span class="co">#&gt; MeanTemperature        15.8981470  17.107689    0</span></span>
<span><span class="co">#&gt; MinTemperature          7.0401778   8.721007    0</span></span>
<span><span class="co">#&gt; MaxTemperature         21.3502767  24.825805    0</span></span>
<span><span class="co">#&gt; Precipitation           0.9568111   4.916280    0</span></span>
<span><span class="co">#&gt; MeanRelativeHumidity   69.2639299  88.634437    0</span></span>
<span><span class="co">#&gt; MinRelativeHumidity    52.5994550  72.780577    0</span></span>
<span><span class="co">#&gt; MaxRelativeHumidity   100.0000000 100.000000    0</span></span>
<span><span class="co">#&gt; Radiation              21.8800875  25.287348    0</span></span>
<span><span class="co">#&gt; WindSpeed               1.8527502   4.348124    5</span></span>
<span><span class="co">#&gt; WindDirection         234.5482210 246.486142  365</span></span>
<span><span class="co">#&gt; PET                     3.4728443   5.069591    0</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;      from to          offset    delta  refsys point x/y</span></span>
<span><span class="co">#&gt; time    1  5 2022-03-28 CEST   7 days POSIXct    NA    </span></span>
<span><span class="co">#&gt; x       1 11           1.671  0.01058  WGS 84 FALSE [x]</span></span>
<span><span class="co">#&gt; y       1 11           41.76 -0.01058  WGS 84 FALSE [y]</span></span></code></pre></div>
<p>In this case the result is the aggregated variables as attributes,
and the time dimension is aggregated in the desired frequency.</p>
</div>
<div class="section level4">
<h4 id="piping-raster-interpolation">Piping raster interpolation<a class="anchor" aria-label="anchor" href="#piping-raster-interpolation"></a>
</h4>
<p>As with points, raster interpolation and utilities can also be piped.
This way, if we are only interested in the mean monthly temperature in
our study area, we can do:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">monthly_mean_temperature</span> <span class="op">&lt;-</span> <span class="va">raster_to_interpolate_example</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/interpolate_data.html">interpolate_data</a></span><span class="op">(</span><span class="va">interpolator</span>, variables <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summarise_interpolated_data.html">summarise_interpolated_data</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>    frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>    variable <span class="op">=</span> <span class="st">"MeanTemperature"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Starting interpolation...</span></span>
<span><span class="co">#&gt; • Interpolating temperature...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolation done...</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Binding together interpolation results</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Interpolation process finished</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">monthly_mean_temperature</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidy-meteoland_files/figure-html/raster_piped-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="equivalence-table">Equivalence table<a class="anchor" aria-label="anchor" href="#equivalence-table"></a>
</h3>
<table class="table">
<colgroup>
<col width="32%">
<col width="37%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Function (&lt; 2.0.0)</th>
<th>Equivalence (&gt;= 2.0.0)</th>
<th>deprecated</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>averagearea</code></td>
<td>No equivalence, aggregating by area can be done with the
<code>sf</code> package</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>
<code>correctionpoint</code>, <code>correctionpoints</code>,
<code>correctionpoints.errors</code>, <code>correction_series</code>,
<code>defaultCorrectionParams</code>
</td>
<td>No equivalence, better bias correction methods are provided by other
packages (see package <code>MBC</code> for example)</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>defaultInterpolationParams</code></td>
<td>No change</td>
<td><code>FALSE</code></td>
</tr>
<tr class="even">
<td>
<code>download_*</code> functions</td>
<td>No equivalence, weather download functions are now provided by
<code>meteospain</code> package</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td>
<code>extractdates</code>, <code>extractgridindex</code>,
<code>extractgridpoints</code>, <code>extractNetCDF</code>,
<code>extractvars</code>
</td>
<td>No equivalence, not needed as the meteo objects are now
<code>sf</code> objects</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>
<code>humidity_*</code> conversion tools</td>
<td>No change</td>
<td><code>FALSE</code></td>
</tr>
<tr class="odd">
<td><code>interpolation.calibration</code></td>
<td><code>interpolator_calibration</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>interpolation.calibration.fmax</code></td>
<td><code>interpolator_calibration</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>interpolation.coverage</code></td>
<td>No equivalence</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>interpolation.cv</code></td>
<td><code>interpolation_cross_validation</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td>
<code>interpolationgrid</code>, <code>interpolationpixels</code>,
<code>interpolationpoints</code>
</td>
<td><code>interpolate_data</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>
<code>mergegrid</code>, <code>mergepoints</code>
</td>
<td>No equivalence, meteorological objects are now <code>sf</code>
objects and can be merged, joined or filtered as any data.frame</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>meteocomplete</code></td>
<td><code>complete_meteo</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>meteoplot</code></td>
<td>No equivalence, meteo objects are now sf objects and can be plotted
as any other data.frame</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>Meteorology_*_Data</code></td>
<td>No equivalence, spatial classes based on <code>sp</code> are now
deprecated in <code>meteoland</code>
</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>
<code>penman</code>, <code>penmanmonteith</code>
</td>
<td>No changes</td>
<td><code>FALSE</code></td>
</tr>
<tr class="odd">
<td><code>plot.interpolation.cv</code></td>
<td>No equivalence</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>precipitation_concentration</code></td>
<td>No equivalence, precipitation_concentration utility is deprecated
and will be removed in future versions</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>precipitation_rainfallErosivity</code></td>
<td><code>precipitation_rainfall_erosivity</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>
<code>radiation_*</code> utility functions</td>
<td>No change</td>
<td><code>FALSE</code></td>
</tr>
<tr class="odd">
<td><code>readmeteorology*</code></td>
<td>No equivalence, spatial classes based on <code>sp</code> are now
deprecated in <code>meteoland</code>
</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>readNetCDF*</code></td>
<td>No equivalence, NetCDF files can be managed with more recent and up
to date R packages (ncmeta, stars…)</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>readWindNinjaWindFields</code></td>
<td>No equivalence</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>reshapemeteospain</code></td>
<td><code>meteospain2meteoland</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>reshapeworldmet</code></td>
<td><code>worldmet2meteoland</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>reshapeweathercan</code></td>
<td>No equivalence, <code>weathercan</code> package was removed from
CRAN and the functions are deprecated</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td>
<code>Spatial**Meteorology</code>,
<code>Spatial**Topography</code>
</td>
<td>No equivalence, spatial classes based on <code>sp</code> are now
deprecated in <code>meteoland</code>
</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>summary*</code></td>
<td>
<code>summarise_interpolate_data</code>,
<code>summarise_interpolator</code>
</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>utils_*</code></td>
<td>No change</td>
<td><code>FALSE</code></td>
</tr>
<tr class="even">
<td>
<code>weathergeneration</code>,
<code>defaultGenerationParams</code>
</td>
<td>No equivalence, current weather generation methods are currently
deprecated because they operate with classes that are deprecated
themselves, but for future versions, we plan to keep the functionality
in new functions.</td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td><code>writemeteorology*</code></td>
<td>No equivalence, spatial classes based on <code>sp</code> are now
deprecated in <code>meteoland</code>
</td>
<td><code>TRUE</code></td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Víctor Granda, Nicolas Martin, Antoine Cabon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
