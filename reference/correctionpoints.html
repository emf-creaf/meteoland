<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistical correction of meteorological variables for a set of points — correctionpoints • meteoland</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical correction of meteorological variables for a set of points — correctionpoints"><meta property="og:description" content="Functions correctionpoint and correctionpoints perform correction of predicted climatic data by applying statistical correction methods (unbiasing, scaling, or quantile mapping) to meteorological variables. Function correctionpoints.errors allows evaluating, for each point, the bias and mean absolute error (MAE) obtained before and after correcting the climate model for the historical period."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">meteoland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistical correction of meteorological variables for a set of points</h1>
    
    <div class="hidden name"><code>correctionpoints.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions <code>correctionpoint</code> and <code>correctionpoints</code> perform correction of predicted climatic data by applying statistical correction methods (unbiasing, scaling, or quantile mapping) to meteorological variables. Function <code>correctionpoints.errors</code> allows evaluating, for each point, the bias and mean absolute error (MAE) obtained before and after correcting the climate model for the historical period.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">correctionpoint</span><span class="op">(</span><span class="va">obs</span>, <span class="va">mod</span>, <span class="va">proj</span>, dates <span class="op">=</span> <span class="cn">NULL</span>, 
                params <span class="op">=</span> <span class="fu"><a href="defaultCorrectionParams.html">defaultCorrectionParams</a></span><span class="op">(</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">correctionpoints</span><span class="op">(</span><span class="va">object</span>, <span class="va">points</span>, topodata <span class="op">=</span> <span class="cn">NULL</span>, dates <span class="op">=</span> <span class="cn">NULL</span>,
                 export <span class="op">=</span> <span class="cn">FALSE</span>, exportDir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, exportFile <span class="op">=</span> <span class="cn">NULL</span>,
                 exportFormat <span class="op">=</span> <span class="st">"meteoland/txt"</span>, metadataFile <span class="op">=</span> <span class="st">"MP.txt"</span>, 
                 corrOut <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">correctionpoints.errors</span><span class="op">(</span><span class="va">object</span>, <span class="va">points</span>, topodata <span class="op">=</span> <span class="cn">NULL</span>, 
                  error.type<span class="op">=</span><span class="st">"residuals.cv"</span>,keep.data <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obs</dt>
<dd><p>A data frame with observed meteorology.</p></dd>
<dt>mod, proj</dt>
<dd><p>Data frame with predicted meteorology for the reference and projection periods, respectively.</p></dd>
<dt>params</dt>
<dd><p>A list with correction params (see <code><a href="defaultCorrectionParams.html">defaultCorrectionParams</a></code>).</p></dd>
<dt>object</dt>
<dd><p>An object of class <code><a href="MeteorologyUncorrectedData-class.html">MeteorologyUncorrectedData-class</a></code> containing the meteorology of more than one point.</p></dd>
<dt>points</dt>
<dd><p>An object of class <code><a href="SpatialPointsMeteorology-class.html">SpatialPointsMeteorology-class</a></code> with the coordinates and historical meteorological data of the locations for which correction of predicted climatic data has to be done. Alternatively, an object of class <code>SpatialPointsDataFrame-class</code> containing the meta data (columns <code>dir</code>,  <code>filename</code> and possibly <code>format</code>) of meteorological files that will be read from the disk.</p></dd>
<dt>topodata</dt>
<dd><p>A data frame with topographic data for each point (i.e. three columns named <code>elevation</code>, <code>slope</code> and <code>aspect</code>). If <code>topodata = NULL</code> then Penman's potential evapotranspiration is not calculated.</p></dd>
<dt>dates</dt>
<dd><p>An object of class <code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Date</a></code> with a subset of dates of the projection period to be corrected. If <code>dates = NULL</code> then all dates in <code>proj</code> or the projection data of <code>object</code> are processed.</p></dd>
<dt>export</dt>
<dd><p>If <code>export = FALSE</code> the result of correction is stored in memory. Otherwise the result is written in the disk (using the format specified in <code>exportFormat</code>).</p></dd>
<dt>exportDir</dt>
<dd><p>Output directory for corrected meteorology data (txt/rds format).</p></dd>
<dt>exportFile</dt>
<dd><p>Output file for corrected meteorology data (netCDF format).</p></dd>
<dt>metadataFile</dt>
<dd><p>The name of the file that will store the meta data describing all written files.</p></dd>
<dt>exportFormat</dt>
<dd><p>Export format for meteorological data (see <code><a href="writemeteorologypoint.html">writemeteorologypoint</a></code>).  If format is <code>"meteoland/txt"</code>,  <code>"meteoland/rds"</code>, <code>"castanea/txt"</code> or <code>"castanea/rds"</code> the function tries to write one file per point in <code>exportDir</code>. If format is <code>"netCDF"</code> the function will write data to a single file specified by <code>exportFile</code>.</p></dd>
<dt>corrOut</dt>
<dd><p>Boolean flag to indicate that correction parameters (i.e. calculated biases) should be included with the output. Setting <code>corrOut = TRUE</code> changes the returned value.</p></dd>
<dt>verbose</dt>
<dd><p>Boolean flag to print process information.</p></dd>
<dt>error.type</dt>
<dd><p>String to specify the error to be evaluated, either <code>"before"</code> (before correction), <code>"residual"</code> (after correction) or <code>"residual.cv"</code> (after correction, but using cross-validation).</p></dd>
<dt>keep.data</dt>
<dd><p>Boolean flag to return the uncorrected/corrected data for the historical period.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Function <code>correctionpoints</code> performs statistical correction of predicted climatic data for all points supplied in <code>points</code> whereas <code>correctionpoint</code> performs statistical correction of one single point. Observed meteorological data for each point typically comes from a nearby meteorological station, but they can be the result of interpolating the meteorology of several stations (see <code><a href="MeteorologyInterpolationData.html">MeteorologyInterpolationData</a></code>) or they can be extracted from reanalyzed meteorology (e.g. EU-WATCH) (see <code><a href="extractNetCDF.html">extractNetCDF</a></code>).</p>
<p>For each target point, <code>correctionpoints</code> function first determines the predicted cell where the point falls according to the euclidean distance in the geographic space of <code>object</code>. Then it calls <code>correctionpoint</code>. In turn, <code>correctionpoint</code> determines the dates that are shared in observed and predicted data for the historical period. These meteorological data of dates are used to conduct the correction of predicted climatic data for the future period. Corrections biases are calculated and applied for the twelve months separately. The user can control the methods used for correction of each meteorological variable by changing the slot <code>params</code> in <code>object</code> (see class <code><a href="MeteorologyUncorrectedData-class.html">MeteorologyUncorrectedData-class</a></code>) or the parameter <code>params</code> to <code>correctionpoint</code>. Three options are allowed (see <code><a href="defaultCorrectionParams.html">defaultCorrectionParams</a></code>): (a) 'unbias' for shifting the mean; (b) 'scaling' for multiplication by a factor; and (c) 'quantmap' for empirical quantile mapping between observed and modelled data (Déqué 2007).</p>
<p>A difficulty arises for quantile mapping when the variables bounded by zero, such as precipitation. As the models tend to drizzle (or may have lower frequency of precipitation events), the probability of precipitation in the model may be greater or lower than that observed. To correct this, when model precipitation is zero an observed value is randomly chosen in the interval where the observed cumulative frequency is less than or equal to the probability of no precipitation in the model. This procedure ensures that the probability of precipitation after correction is equal to that observed (Boé 2007).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <ul><li><p>Function <code>correctionpoint</code> returns a data frame.</p></li>
<li><p>If <code>export = FALSE</code>, the function <code>correctionpoints</code> returns an object of class <code><a href="SpatialPointsMeteorology-class.html">SpatialPointsMeteorology-class</a></code> with the bias-corrected meteorology for each point. If <code>export=TRUE</code> then bias-corrected data is written into the disk. For txt/rds export formats, the function returns an object of class <code>SpatialPointsDataFrame-class</code> containing the meta data of the files written in the disk. For netCDF export format the function returns <code>NULL</code>. If <code>corrOut = TRUE</code> the function returns a list which contains any previous output and an object with the calculated correction factors (biases, mappings) for each point and month.</p></li>
<li><p>Function <code>correctionpoints.errors</code> (<code>keep.data = FALSE</code>) returns a data frame with the mean absolute error (MAE) and bias for each variable and point. If <code>keep.data = TRUE</code> then the function also returns a list of data frames with the uncorrected/corrected series used in the comparisons with observations.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Boé J, Terray L, Habets F, Martin E (2007) Statistical and dynamical downscaling of the Seine basin climate for hydro-meteorological studies. Int J Climatol 27:1643–1655. doi: 10.1002/joc.1602</p>
<p>De Caceres M, Martin-StPaul N, Turco M, Cabon A, Granda V (2018) Estimating daily meteorological data and downscaling climate models over landscapes. Environmental Modelling and Software 108: 186-196.</p>
<p>Déqué M (2007) Frequency of precipitation and temperature extremes over France in an anthropogenic scenario: Model results and statistical correction according to observed values. Glob Planet Change 57:16–26. doi: 10.1016/j.gloplacha.2006.11.030</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa, CREAF</p>
<p>Nicolas Martin, INRA-Avignon</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="penman.html">penman</a></code>, <code><a href="SpatialPointsMeteorology-class.html">SpatialPointsMeteorology-class</a></code>, <code><a href="writemeteorologypoint.html">writemeteorologypointfiles</a></code>, <code><a href="MeteorologyUncorrectedData.html">MeteorologyUncorrectedData</a></code>, <code><a href="MeteorologyInterpolationData.html">MeteorologyInterpolationData</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">examplegridtopography</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exampleinterpolationdata</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">examplecorrectiondata</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Creates spatial topography points from the grid</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span>
<span class="r-in"><span class="va">spt</span> <span class="op">=</span> <span class="fu">as</span><span class="op">(</span><span class="va">examplegridtopography</span>, <span class="st">"SpatialPointsTopography"</span><span class="op">)</span><span class="op">[</span><span class="va">p</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Interpolation of two points for the whole time period (2000-2003)</span></span>
<span class="r-in"><span class="va">historical</span> <span class="op">=</span> <span class="fu"><a href="interpolationpoints.html">interpolationpoints</a></span><span class="op">(</span><span class="va">exampleinterpolationdata</span>, <span class="va">spt</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing point '1' (1/2) - done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing point '2' (2/2) - done.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Downscaling of future predictions (RCM models, year 2023)</span></span>
<span class="r-in"><span class="va">predicted</span> <span class="op">=</span> <span class="fu">correctionpoints</span><span class="op">(</span><span class="va">examplecorrectiondata</span>, <span class="va">historical</span>, <span class="va">spt</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Points to correct: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All points inside boundary box.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correcting point '1' (1/2) - ipred = 3 done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correcting point '2' (2/2) - ipred = 3 done.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Plot predicted mean temperature for point 1</span></span>
<span class="r-in"><span class="fu"><a href="meteoplot.html">meteoplot</a></span><span class="op">(</span><span class="va">predicted</span>, <span class="fl">1</span>, <span class="st">"MeanTemperature"</span>, ylab<span class="op">=</span><span class="st">"Temperature (Celsius)"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="meteoplot.html">meteoplot</a></span><span class="op">(</span><span class="va">predicted</span>, <span class="fl">1</span>, <span class="st">"MinTemperature"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="meteoplot.html">meteoplot</a></span><span class="op">(</span><span class="va">predicted</span>, <span class="fl">1</span>, <span class="st">"MaxTemperature"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#Add uncorrected mean temperature data (cell #3)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">dates</span>,</span>
<span class="r-in">      <span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">projection_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">MeanTemperature</span>,</span>
<span class="r-in">      lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">dates</span>,</span>
<span class="r-in">      <span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">projection_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">MinTemperature</span>,</span>
<span class="r-in">      col<span class="op">=</span><span class="st">"blue"</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">dates</span>,</span>
<span class="r-in">      <span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">projection_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">MaxTemperature</span>,</span>
<span class="r-in">      col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"corrected"</span>,<span class="st">"uncorrected"</span>, <span class="st">"Maximum"</span>, <span class="st">"Mean"</span>, <span class="st">"Minimum"</span><span class="op">)</span>, </span>
<span class="r-in">       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"black"</span>, <span class="st">"red"</span>,<span class="st">"black"</span>,<span class="st">"blue"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="correctionpoints-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Scatter plot</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">projection_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">MeanTemperature</span>,</span>
<span class="r-in">     <span class="va">predicted</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">MeanTemperature</span>, cex<span class="op">=</span><span class="fl">0.1</span>, asp<span class="op">=</span><span class="fl">1</span>,</span>
<span class="r-in">     ylab<span class="op">=</span><span class="st">"Corrected mean temperature"</span>, xlab<span class="op">=</span><span class="st">"Uncorrected mean temperature"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="correctionpoints-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Plot predicted precipitation for point 1</span></span>
<span class="r-in"><span class="fu"><a href="meteoplot.html">meteoplot</a></span><span class="op">(</span><span class="va">predicted</span>, <span class="fl">1</span>, <span class="st">"Precipitation"</span>, ylab<span class="op">=</span><span class="st">"Precipitation (mm)"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">120</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#Add uncorrected mean temperature data (cell #3)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">dates</span>,</span>
<span class="r-in">      <span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">projection_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Precipitation</span>,</span>
<span class="r-in">      col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"corrected"</span>,<span class="st">"uncorrected"</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="correctionpoints-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#Scatter plot</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">examplecorrectiondata</span><span class="op">@</span><span class="va">projection_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Precipitation</span>,</span>
<span class="r-in">     <span class="va">predicted</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Precipitation</span>, cex<span class="op">=</span><span class="fl">0.1</span>, asp<span class="op">=</span><span class="fl">1</span>,</span>
<span class="r-in">     ylab<span class="op">=</span><span class="st">"Corrected precipitation (mm)"</span>, xlab<span class="op">=</span><span class="st">"Uncorrected precipitation (mm)"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="correctionpoints-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres, Nicolas Martin, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

