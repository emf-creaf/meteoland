<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calibration and validation of interpolation procedures — interpolation.cv • meteoland</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calibration and validation of interpolation procedures — interpolation.cv" />
<meta property="og:description" content="Function interpolation.calibration determines optimal interpolation parameters 'N' and 'alpha' for a given meteorological variable. Optimization is done by minimizing mean absolute error (MAE) (Thornton et al. 1997). Function interpolation.cv calculates average mean absolute errors (MAE) for the prediction period of an object of class 'MeteorologyInterpolationData'.  Function summary.interpolation.cv returns a data.frame with cross-validation  summaries and plot.interpolation.cv plots cross-validation results. In both calibration and validation procedures, predictions for each weather station are made using a leave-one-out procedure (i.e. after excluding the station from the predictive set)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">meteoland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calibration and validation of interpolation procedures</h1>
    
    <div class="hidden name"><code>interpolation.cv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>interpolation.calibration</code> determines optimal interpolation parameters 'N' and 'alpha' for a given meteorological variable. Optimization is done by minimizing mean absolute error (MAE) (Thornton et al. 1997). Function <code>interpolation.cv</code> calculates average mean absolute errors (MAE) for the prediction period of an object of class '<code>MeteorologyInterpolationData</code>'.  Function <code>summary.interpolation.cv</code> returns a data.frame with cross-validation  summaries and <code>plot.interpolation.cv</code> plots cross-validation results. In both calibration and validation procedures, predictions for each weather station are made using a leave-one-out procedure (i.e. after excluding the station from the predictive set).</p>
    </div>

    <pre class="usage"><span class='fu'>interpolation.calibration</span><span class='op'>(</span><span class='va'>object</span>, stations <span class='op'>=</span> <span class='cn'>NULL</span>, variable<span class='op'>=</span><span class='st'>"Tmin"</span>,
                        N_seq <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>30</span>, by<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>, alpha_seq <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.25</span>,<span class='fl'>10</span>, by<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span>,
                        verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>interpolation.calibration.fmax</span><span class='op'>(</span><span class='va'>object</span>, stations <span class='op'>=</span> <span class='cn'>NULL</span>, 
                               fmax_seq <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.05</span>,<span class='fl'>0.95</span>, by<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>, 
                               verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>                        
<span class='fu'>interpolation.cv</span><span class='op'>(</span><span class='va'>object</span>, stations <span class='op'>=</span> <span class='cn'>NULL</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># S3 method for interpolation.cv</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for interpolation.cv</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>"stations"</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>In the case of function <code>interpolation.cv</code>, an object of class <code><a href='MeteorologyInterpolationData-class.html'>MeteorologyInterpolationData-class</a></code>. In the case of function <code>summary</code>, an object of class <code>interpolation.cv</code></p></td>
    </tr>
    <tr>
      <th>stations</th>
      <td><p>A numeric vector containing the indices of stations to be used to calculate mean absolute errors (MAE) in the calibration or cross-validation analysis. All the stations with data are included in the training set but predictive MAE are calculated for the 'stations' subset only.</p></td>
    </tr>
    <tr>
      <th>variable</th>
      <td><p>A string indicating the meteorological variable for which interpolation parameters 'N' and 'alpha' will be calibrated. Accepted values are 'Tmin' (for minimum temperature), 'Tmax' (for maximum temperature), 'Tdew' (for dew-point temperature), 'PrecEvent' (for precipitation events),'PrecAmount' (for regression of precipitation amounts),'Prec' (for precipitation with the same values for precipitation events and regression of precipitation amounts).</p></td>
    </tr>
    <tr>
      <th>N_seq</th>
      <td><p>Set of average number of points to be tested.</p></td>
    </tr>
    <tr>
      <th>alpha_seq</th>
      <td><p>Set of alpha values to be tested.</p></td>
    </tr>
    <tr>
      <th>fmax_seq</th>
      <td><p>Set of f_max values to be tested.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical flag to generate additional console output.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A S3 object of class <code>interpolation.cv</code> with cross-validation results.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A string of the plot type to be produced (either "stations" or "dates").</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters passed to summary and plot functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function <code>interpolation.calibration</code> returns an object of class <code>'interpolation.calibration'</code>  with the following items:</p><ul>
<li><p><code>MAE</code>: A numeric matrix with the mean absolute error values (averaged across stations) for each combination of parameters 'N' and 'alpha'.</p></li>
<li><p><code>minMAE</code>: Minimum MAE value.</p></li>
<li><p><code>N</code>: Value of parameter 'N' corresponding to the minimum MAE.</p></li>
<li><p><code>alpha</code>: Value of parameter 'alpha' corresponding to the minimum MAE.</p></li>
<li><p><code>Observed</code>: A matrix with observed values.</p></li>
<li><p><code>Predicted</code>: A matrix with predicted values for the optimum parameter combination.</p></li>
</ul><p>Function <code>interpolation.cv</code> returns a list of class <code>'interpolation.cv'</code> with the following items:</p><ul>
<li><p><code>stations</code>: A data frame with as many rows as weather stations and the following columns:
<ul>
<li><p><code>MinTemperature-Bias</code>: Bias (in degrees), calculated over the prediction period, of minimum temperature estimations in weather stations.</p></li>
<li><p><code>MinTemperature-MAE</code>: Mean absolute errors (in degrees), averaged over the prediction period, of minimum temperature estimations in weather stations.</p></li>
<li><p><code>MaxTemperature-Bias</code>: Bias (in degrees), calculated over the prediction period, of maximum temperature estimations in weather stations.</p></li>
<li><p><code>MaxTemperature-MAE</code>: Mean absolute errors (in degrees), averaged over the prediction period, of maximum temperature estimations in weather stations.</p></li>
<li><p><code>Precipitation-Total</code>: Difference in the total precipitation of the studied period.</p></li>
<li><p><code>Precipitation-DPD</code>: Difference in the proportion of days with precipitation.</p></li>
<li><p><code>Precipitation-Bias</code>: Bias (in mm), calculated over the days with precipitation, of precipitation amount estimations in weather stations.</p></li>
<li><p><code>Precipitation-MAE</code>: Mean absolute errors (in mm), averaged over the days with precipitation, of precipitation amount estimations in weather stations.</p></li>
<li><p><code>RelativeHumidity-Bias</code>: Bias (in percent), calculated over the prediction period, of relative humidity estimations in weather stations.</p></li>
<li><p><code>RelativeHumidity-MAE</code>: Mean absolute errors (in percent), averaged over the prediction period, of relative humidity estimations in weather stations.</p></li>
<li><p><code>Radiation-Bias</code>: Bias (in MJ/m2), calculated over the prediction period, of incoming radiation estimations in weather stations.</p></li>
<li><p><code>Radiation-MAE</code>: Mean absolute errors (in MJ/m2), averaged over the prediction period, of incoming radiation estimations in weather stations.</p></li>
</ul></p></li>
<li><p><code>dates</code>: A data frame with as many rows as weather stations and the following columns:
<ul>
<li><p><code>MinTemperature-Bias</code>: Daily bias (in degrees), averaged over the stations, of minimum temperature estimations.</p></li>
<li><p><code>MinTemperature-MAE</code>: Daily mean absolute error (in degrees), averaged over the stations, of minimum temperature estimations.</p></li>
<li><p><code>MaxTemperature-Bias</code>: Daily bias (in degrees), averaged over the stations, of maximum temperature estimations.</p></li>
<li><p><code>MaxTemperature-MAE</code>: Daily mean absolute error (in degrees), averaged over the stations, of maximum temperature estimations.</p></li>
<li><p><code>Precipitation-Bias</code>: Daily bias (in mm), averaged over the stations, of precipitation amount estimations.</p></li>
<li><p><code>Precipitation-MAE</code>: Daily mean absolute error (in mm), averaged over the stations, of precipitation amount estimations.</p></li>
<li><p><code>RelativeHumidity-Bias</code>: Daily bias (in percent), averaged over the stations, of relative humidity estimations.</p></li>
<li><p><code>RelativeHumidity-MAE</code>: Daily mean absolute error (in percent), averaged over the stations, of relative humidity estimations.</p></li>
<li><p><code>Radiation-Bias</code>: Daily bias (in MJ/m2), averaged over the stations, of incoming radiation estimations.</p></li>
<li><p><code>Radiation-MAE</code>: Daily mean absolute errors (in MJ/m2), averaged over the stations, of incoming radiation estimations.</p></li>
</ul></p></li>
<li><p><code>MinTemperature</code>: A data frame with predicted minimum temperature values.</p></li>
<li><p><code>MinTemperatureError</code>: A matrix with predicted minimum temperature errors.</p></li>
<li><p><code>MaxTemperature</code>: A data frame with predicted maximum temperature values.</p></li>
<li><p><code>MaxTemperatureError</code>: A matrix with predicted maximum temperature errors.</p></li>
<li><p><code>Precipitation</code>: A data frame with predicted precipitation values.</p></li>
<li><p><code>PrecipitationError</code>: A matrix with predicted precipitation errors.</p></li>
<li><p><code>RelativeHumidity</code>: A data frame with predicted relative humidity values.</p></li>
<li><p><code>RelativeHumidityError</code>: A matrix with predicted relative humidity errors.</p></li>
<li><p><code>Radiation</code>: A data frame with predicted radiation values.</p></li>
<li><p><code>RadiationError</code>: A matrix with predicted radiation errors.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Thornton, P.E., Running, S.W., 1999. An improved algorithm for estimating incident daily solar radiation from measurements of temperature, humidity, and precipitation. Agric. For. Meteorol. 93, 211–228. doi:10.1016/S0168-1923(98)00126-9.</p>
<p>De Caceres M, Martin-StPaul N, Turco M, Cabon A, Granda V (2018) Estimating daily meteorological data and downscaling climate models over landscapes. Environmental Modelling and Software 108: 186-196.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Miquel De Cáceres Ainsa, CREAF</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='MeteorologyInterpolationData.html'>MeteorologyInterpolationData</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>exampleinterpolationdata</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Calibration procedure</span></span>
<span class='r-in'><span class='va'>precEv_cal</span> <span class='op'>=</span> <span class='fu'>interpolation.calibration</span><span class='op'>(</span><span class='va'>exampleinterpolationdata</span>, variable<span class='op'>=</span><span class='st'>"PrecEvent"</span>,</span>
<span class='r-in'>                                       stations <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>,</span>
<span class='r-in'>                                       N_seq<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>15</span><span class='op'>)</span>, alpha_seq<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.25</span>,<span class='fl'>1.0</span>, by<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span>,</span>
<span class='r-in'>                                       verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Total number of stations: 38</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of stations with available data: 16</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of stations used for MAE: 5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of parameter combinations to test: 12</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Evaluation of parameter combinations...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 0.25 MAE = 0.0895447403786471</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 0.5 MAE = 0.0889836492139592</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 0.75 MAE = 0.0901869217409675</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 1 MAE = 0.0911038160766583</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 0.25 MAE = 0.0958862948272703</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 0.5 MAE = 0.0968173564162686</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 0.75 MAE = 0.0988071801268628</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 1 MAE = 0.0982699429850222</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 0.25 MAE = 0.0941500173316747</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 0.5 MAE = 0.0945582680083739</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 0.75 MAE = 0.0949859235219239</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 1 MAE = 0.0951681828290314</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Minimum MAE value: 0.0889836492139592 N: 5 alpha: 0.5</span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>precAm_cal</span> <span class='op'>=</span> <span class='fu'>interpolation.calibration</span><span class='op'>(</span><span class='va'>exampleinterpolationdata</span>, variable<span class='op'>=</span><span class='st'>"PrecAmount"</span>,</span>
<span class='r-in'>                                       stations <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>,</span>
<span class='r-in'>                                       N_seq<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>15</span><span class='op'>)</span>, alpha_seq<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.25</span>,<span class='fl'>1.0</span>, by<span class='op'>=</span><span class='fl'>0.25</span><span class='op'>)</span>,</span>
<span class='r-in'>                                       verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Total number of stations: 38</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of stations with available data: 16</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of stations used for MAE: 5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of parameter combinations to test: 12</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Evaluation of parameter combinations...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 0.25 MAE = 0.273167151065456</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 0.5 MAE = 0.272226669811487</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 0.75 MAE = 0.271176037084119</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 5 alpha: 1 MAE = 0.270199795609907</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 0.25 MAE = 0.258270974301504</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 0.5 MAE = 0.257332263984421</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 0.75 MAE = 0.256377607920915</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 10 alpha: 1 MAE = 0.255466858038992</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 0.25 MAE = 0.260453126318062</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 0.5 MAE = 0.259086237248335</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 0.75 MAE = 0.258073663584152</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    N: 15 alpha: 1 MAE = 0.25718075870868</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Minimum MAE value: 0.255466858038992 N: 10 alpha: 1</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Set 'alpha' and 'N' parameters to values found in calibration</span></span>
<span class='r-in'><span class='va'>exampleinterpolationdata</span><span class='op'>@</span><span class='va'>params</span><span class='op'>$</span><span class='va'>N_PrecipitationEvent</span> <span class='op'>=</span> <span class='va'>precEv_cal</span><span class='op'>$</span><span class='va'>N</span></span>
<span class='r-in'><span class='va'>exampleinterpolationdata</span><span class='op'>@</span><span class='va'>params</span><span class='op'>$</span><span class='va'>alpha_PrecipitationEvent</span> <span class='op'>=</span> <span class='va'>precEv_cal</span><span class='op'>$</span><span class='va'>alpha</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>exampleinterpolationdata</span><span class='op'>@</span><span class='va'>params</span><span class='op'>$</span><span class='va'>N_PrecipitationAmount</span> <span class='op'>=</span> <span class='va'>precAm_cal</span><span class='op'>$</span><span class='va'>N</span></span>
<span class='r-in'><span class='va'>exampleinterpolationdata</span><span class='op'>@</span><span class='va'>params</span><span class='op'>$</span><span class='va'>alpha_PrecipitationAmount</span> <span class='op'>=</span> <span class='va'>precAm_cal</span><span class='op'>$</span><span class='va'>alpha</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Run cross validation</span></span>
<span class='r-in'><span class='va'>cv</span> <span class='op'>=</span> <span class='fu'>interpolation.cv</span><span class='op'>(</span><span class='va'>exampleinterpolationdata</span>, stations <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station #1 C7</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station #2 C8</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station #3 CA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station #4 VD</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station #5 VP</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Print cross validation summaries</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cv</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                               n         r         MAE sd.station.MAE</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MinTemperature             7272 0.9806085   1.1129706      0.2912159</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MaxTemperature             7269 0.9863357   1.0803430      0.5960223</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> TemperatureRange           7269 0.8874818   1.5808809      0.3207088</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> RelativeHumidity              0        NA         NaN             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Radiation                     0        NA         NaN             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.rainfall              5 0.8099750 133.6822373     95.4727612</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.rainfall.relative     5        NA   7.7362137      7.1312986</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.precdays              5 0.3464714  97.2000000     90.1703943</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.precdays.relative     5        NA  22.3023469     15.5173989</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.rainfall               436 0.8559395   9.6635409             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.rainfall.relative      436        NA         Inf             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.precstations           436 0.5878517   0.9288991             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.precstations.relative  436        NA         Inf             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                            sd.dates.MAE         Bias sd.station.Bias</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MinTemperature                0.4937948  -0.60089892       0.7419034</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MaxTemperature                0.4984377   0.26685955       1.1027684</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> TemperatureRange              0.6772156   0.86756996       1.2263958</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> RelativeHumidity                     NA          NaN              NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Radiation                            NA          NaN              NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.rainfall                     NA  13.21044895     176.7359016</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.rainfall.relative            NA   1.69029959      11.0496733</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.precdays                     NA -97.20000000      90.1703943</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.precdays.relative            NA -22.30234690      15.5173989</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.rainfall                14.5522820   1.72718405              NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.rainfall.relative              NaN          Inf              NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.precstations             1.1333968  -0.06192661              NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.precstations.relative          NaN          Inf              NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                            sd.dates.Bias</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MinTemperature                 0.7780421</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MaxTemperature                 0.6326580</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> TemperatureRange               0.8921691</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> RelativeHumidity                      NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Radiation                             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.rainfall                      NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.rainfall.relative             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.precdays                      NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Station.precdays.relative             NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.rainfall                 17.3890077</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.rainfall.relative               NaN</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.precstations              1.4647804</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Date.precstations.relative           NaN</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Plot results</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='interpolation.cv-1.png' alt='' width='700' height='433' /></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Miquel De Cáceres, Nicolas Martin, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


