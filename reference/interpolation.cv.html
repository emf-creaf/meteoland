<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calibration and validation of interpolation procedures — interpolation.calibration • meteoland</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calibration and validation of interpolation procedures — interpolation.calibration"><meta property="og:description" content="
Function interpolation.calibration determines optimal interpolation
parameters 'N' and 'alpha' for a given meteorological variable. Optimization
is done by minimizing mean absolute error (MAE) (Thornton et al. 1997).
Function interpolation.cv calculates average mean absolute errors
(MAE) for the prediction period of an object of class
'MeteorologyInterpolationData'.  Function
summary returns a data.frame with cross-validation
summaries and plot plots cross-validation results.
In both calibration and validation procedures, predictions for each weather
station are made using a leave-one-out procedure (i.e. after excluding the
station from the predictive set)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">meteoland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calibration and validation of interpolation procedures</h1>
    
    <div class="hidden name"><code>interpolation.cv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p>
<p>Function <code>interpolation.calibration</code> determines optimal interpolation
parameters 'N' and 'alpha' for a given meteorological variable. Optimization
is done by minimizing mean absolute error (MAE) (Thornton et al. 1997).
Function <code>interpolation.cv</code> calculates average mean absolute errors
(MAE) for the prediction period of an object of class
'<code>MeteorologyInterpolationData</code>'.  Function
<code>summary</code> returns a data.frame with cross-validation
summaries and <code>plot</code> plots cross-validation results.
In both calibration and validation procedures, predictions for each weather
station are made using a leave-one-out procedure (i.e. after excluding the
station from the predictive set).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">interpolation.calibration</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  stations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Tmin"</span>,</span>
<span>  N_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  alpha_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">interpolation.calibration.fmax</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  stations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fmax_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">interpolation.cv</span><span class="op">(</span><span class="va">object</span>, stations <span class="op">=</span> <span class="cn">NULL</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for interpolation.cv</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"stations"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for interpolation.cv</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>In the case of function <code>interpolation.cv</code>, an object of
class <code><a href="MeteorologyInterpolationData-class.html">MeteorologyInterpolationData-class</a></code>. In the case of
function <code>summary</code>, an object of class <code>interpolation.cv</code></p></dd>


<dt>stations</dt>
<dd><p>A numeric vector containing the indices of stations to be
used to calculate mean absolute errors (MAE) in the calibration or
cross-validation analysis. All the stations with data are included in the
training set but predictive MAE are calculated for the 'stations' subset
only.</p></dd>


<dt>variable</dt>
<dd><p>A string indicating the meteorological variable for which
interpolation parameters 'N' and 'alpha' will be calibrated. Accepted values
are 'Tmin' (for minimum temperature), 'Tmax' (for maximum temperature),
'Tdew' (for dew-point temperature), 'PrecEvent' (for precipitation
events),'PrecAmount' (for regression of precipitation amounts),'Prec' (for
precipitation with the same values for precipitation events and regression
of precipitation amounts).</p></dd>


<dt>N_seq</dt>
<dd><p>Set of average number of points to be tested.</p></dd>


<dt>alpha_seq</dt>
<dd><p>Set of alpha values to be tested.</p></dd>


<dt>verbose</dt>
<dd><p>A logical flag to generate additional console output.</p></dd>


<dt>fmax_seq</dt>
<dd><p>Set of f_max values to be tested.</p></dd>


<dt>x</dt>
<dd><p>A S3 object of class <code>interpolation.cv</code> with cross-validation
results.</p></dd>


<dt>type</dt>
<dd><p>A string of the plot type to be produced (either "stations" or
"dates").</p></dd>


<dt>...</dt>
<dd><p>Additional parameters passed to summary and plot functions.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Function <code>interpolation.calibration</code> returns an object of class
<code>'interpolation.calibration'</code> with the following items:</p><ul><li><p><code>MAE</code>: A numeric matrix with the mean absolute error values
(averaged across stations) for each combination of parameters 'N' and
'alpha'.</p></li>
<li><p><code>minMAE</code>: Minimum MAE value.</p></li>
<li><p><code>N</code>: Value of
parameter 'N' corresponding to the minimum MAE.</p></li>
<li><p><code>alpha</code>: Value of
parameter 'alpha' corresponding to the minimum MAE.</p></li>
<li><p><code>Observed</code>: A
matrix with observed values.</p></li>
<li><p><code>Predicted</code>: A matrix with predicted
values for the optimum parameter combination.</p></li>
</ul><p>Function
<code>interpolation.cv</code> returns a list of class <code>'interpolation.cv'</code></p>


<p>with the following items:</p><ul><li><p><code>stations</code>: A data frame with
as many rows as weather stations and the following columns:</p><ul><li><p><code>MinTemperature-Bias</code>: Bias (in degrees), calculated over the
prediction period, of minimum temperature estimations in weather stations.</p></li>
<li><p><code>MinTemperature-MAE</code>: Mean absolute errors (in degrees), averaged
over the prediction period, of minimum temperature estimations in weather
stations.</p></li>
<li><p><code>MaxTemperature-Bias</code>: Bias (in degrees), calculated
over the prediction period, of maximum temperature estimations in weather
stations.</p></li>
<li><p><code>MaxTemperature-MAE</code>: Mean absolute errors (in degrees),
averaged over the prediction period, of maximum temperature estimations in
weather stations.</p></li>
<li><p><code>Precipitation-Total</code>: Difference in the total
precipitation of the studied period.</p></li>
<li><p><code>Precipitation-DPD</code>:
Difference in the proportion of days with precipitation.</p></li>
<li><p><code>Precipitation-Bias</code>: Bias (in mm), calculated over the days with
precipitation, of precipitation amount estimations in weather stations.</p></li>
<li><p><code>Precipitation-MAE</code>: Mean absolute errors (in mm), averaged over
the days with precipitation, of precipitation amount estimations in weather
stations.</p></li>
<li><p><code>RelativeHumidity-Bias</code>: Bias (in percent), calculated
over the prediction period, of relative humidity estimations in weather
stations.</p></li>
<li><p><code>RelativeHumidity-MAE</code>: Mean absolute errors (in
percent), averaged over the prediction period, of relative humidity
estimations in weather stations.</p></li>
<li><p><code>Radiation-Bias</code>: Bias (in
MJ/m2), calculated over the prediction period, of incoming radiation
estimations in weather stations.</p></li>
<li><p><code>Radiation-MAE</code>: Mean absolute
errors (in MJ/m2), averaged over the prediction period, of incoming
radiation estimations in weather stations.</p></li>
</ul></li>
<li><p><code>dates</code>: A data frame with as many rows as weather stations and
the following columns:</p><ul><li><p><code>MinTemperature-Bias</code>: Daily bias
(in degrees), averaged over the stations, of minimum temperature
estimations.</p></li>
<li><p><code>MinTemperature-MAE</code>: Daily mean absolute error (in
degrees), averaged over the stations, of minimum temperature estimations.</p></li>
<li><p><code>MaxTemperature-Bias</code>: Daily bias (in degrees), averaged over the
stations, of maximum temperature estimations.</p></li>
<li><p><code>MaxTemperature-MAE</code>: Daily mean absolute error (in degrees),
averaged over the stations, of maximum temperature estimations.</p></li>
<li><p><code>Precipitation-Bias</code>: Daily bias (in mm), averaged over the
stations, of precipitation amount estimations.</p></li>
<li><p><code>Precipitation-MAE</code>: Daily mean absolute error (in mm), averaged
over the stations, of precipitation amount estimations.</p></li>
<li><p><code>RelativeHumidity-Bias</code>: Daily bias (in percent), averaged over
the stations, of relative humidity estimations.</p></li>
<li><p><code>RelativeHumidity-MAE</code>: Daily mean absolute error (in percent),
averaged over the stations, of relative humidity estimations.</p></li>
<li><p><code>Radiation-Bias</code>: Daily bias (in MJ/m2), averaged over the
stations, of incoming radiation estimations.</p></li>
<li><p><code>Radiation-MAE</code>:
Daily mean absolute errors (in MJ/m2), averaged over the stations, of
incoming radiation estimations.</p></li>
</ul></li>
<li><p><code>MinTemperature</code>: A data frame with predicted minimum temperature
values.</p></li>
<li><p><code>MinTemperatureError</code>: A matrix with predicted minimum
temperature errors.</p></li>
<li><p><code>MaxTemperature</code>: A data frame with predicted
maximum temperature values.</p></li>
<li><p><code>MaxTemperatureError</code>: A matrix with
predicted maximum temperature errors.</p></li>
<li><p><code>Precipitation</code>: A data
frame with predicted precipitation values.</p></li>
<li><p><code>PrecipitationError</code>: A
matrix with predicted precipitation errors.</p></li>
<li><p><code>RelativeHumidity</code>: A
data frame with predicted relative humidity values.</p></li>
<li><p><code>RelativeHumidityError</code>: A matrix with predicted relative humidity
errors.</p></li>
<li><p><code>Radiation</code>: A data frame with predicted radiation values.</p></li>
<li><p><code>RadiationError</code>: A matrix with predicted radiation errors.</p></li>
</ul></div>
    <div id="methods-by-generic-">
    <h2>Methods (by generic)</h2>
    
<ul><li><p><code>plot(interpolation.cv)</code>: <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p></li>
<li><p><code>summary(interpolation.cv)</code>: <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p></li>
</ul></div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>interpolation.calibration()</code>: <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p></li>
<li><p><code>interpolation.calibration.fmax()</code>: <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Thornton, P.E., Running, S.W., 1999. An improved algorithm for
estimating incident daily solar radiation from measurements of temperature,
humidity, and precipitation. Agric. For. Meteorol. 93, 211–228.
doi:10.1016/S0168-1923(98)00126-9.</p>
<p>De Caceres M, Martin-StPaul N, Turco M, Cabon A, Granda V (2018) Estimating
daily meteorological data and downscaling climate models over landscapes.
Environmental Modelling and Software 108: 186-196.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="MeteorologyInterpolationData.html">MeteorologyInterpolationData</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa, CREAF</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres, Víctor Granda, Nicolas Martin, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

