<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Weather generation — weathergeneration • meteoland</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Weather generation — weathergeneration"><meta property="og:description" content="
A semiparametric multivariate, multisite weather generator. The algorithm
can be interpreted as a way to resample the original data to create
synthetic data sets of the same length and similar properties."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">meteoland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weather generation</h1>
    
    <div class="hidden name"><code>weathergeneration.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p>
<p>A semiparametric multivariate, multisite weather generator. The algorithm
can be interpreted as a way to resample the original data to create
synthetic data sets of the same length and similar properties.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">weathergeneration</span><span class="op">(</span><span class="va">object</span>, params <span class="op">=</span> <span class="fu"><a href="defaultGenerationParams.html">defaultGenerationParams</a></span><span class="op">(</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object of class
<code><a href="SpatialPointsMeteorology-class.html">SpatialPointsMeteorology-class</a></code>,
<code><a href="SpatialGridMeteorology-class.html">SpatialGridMeteorology-class</a></code> or
<code><a href="SpatialPixelsMeteorology-class.html">SpatialPixelsMeteorology-class</a></code>.</p></dd>


<dt>params</dt>
<dd><p>A list with parameters for the weather generator (see
<code><a href="defaultGenerationParams.html">defaultGenerationParams</a></code>).</p></dd>


<dt>verbose</dt>
<dd><p>Boolean flag to print process information.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of the same class as the input <code>object</code>. Generated
meteorological series are of the same length as the input.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The implemented algorithm is based on Apipattanavis et al. (2007) for the
non-conditional version, and is similar to Steinschneider et al. (2013) for
the conditional one. Part of the code was adapted from package 'weathergen'
by Jeffrey D. Walker, whom we are grateful. Conditioning is controlled via
the element <code>conditional</code> of <code>params</code> list, which can be:</p><ul><li><p><code>"none"</code> - The non-conditional version is used, which is
based on a first order Markov chain (MC) to simulate weather states
(dry/wet/extreme wet) and a K-nearest neighbour (KNN) algorithm to select
pairs of days with the same transition and similar weather for the initial
state (as in Apipattanavis et al. 2007).</p></li>
<li><p><code>"arima"</code> - Annual
precipitation is conditioned using a stationary auto-regressive (ARIMA)
model and then a K-nearest neighbour algorithm is used to select a set of
years to train the MC-KNN algorithm (similar to Steinschneider et al. 2013).
Recommended if low-frequency variation of annual precipitation is to be
acounted for in long series.</p></li>
<li><p><code>"window"</code> - The MC-KNN algorithm is
trained with the subset of the input data corresponding to a window around
the target year. Annual precipitation is conditioned using a lognormal
random trial of the precipitation corresponding to the selected years.
Recommended to generate stochastic series from climate change projections.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Apipattanavis, S., G. Podesta, B. Rajagopalan, and R. W. Katz
(2007), A semiparametric multivariate and multisite weather generator, Water
Resour. Res., 43, W11401, doi:10.1029/2006WR005714.</p>
<p>Steinschneider S., and Brown C. (2013) A semiparametric multivariate,
multisite weather generator with low-frequency variability for use in
climate risk assessments. Water Resour. Res., 49, 7205-7220,
doi:10.1002/wrcr.20528.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="defaultGenerationParams.html">defaultGenerationParams</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa, CREAF</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">examplegridtopography</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exampleinterpolationdata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Creates spatial topography points from the grid</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">spt</span> <span class="op">=</span> <span class="fu">as</span><span class="op">(</span><span class="va">examplegridtopography</span>, <span class="st">"SpatialPointsTopography"</span><span class="op">)</span><span class="op">[</span><span class="va">p</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Interpolation of two points for the whole time period (2000-2003)</span></span></span>
<span class="r-in"><span><span class="va">mp</span> <span class="op">=</span> <span class="fu"><a href="interpolationpoints.html">interpolationpoints</a></span><span class="op">(</span><span class="va">exampleinterpolationdata</span>, <span class="va">spt</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>PROJ support is provided by the sf and terra packages among others</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing point '1' (1/2) - done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing point '2' (2/2) - done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plot interpolated meteorological series</span></span></span>
<span class="r-in"><span><span class="fu"><a href="meteoplot.html">meteoplot</a></span><span class="op">(</span><span class="va">mp</span>,<span class="fl">1</span>, ylab<span class="op">=</span><span class="st">"Mean temperature"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="weathergeneration-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Generate a stochastic series using interpolated data as template</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu">weathergeneration</span><span class="op">(</span><span class="va">mp</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`weathergeneration()` was deprecated in meteoland 2.0.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Current weather generation methods are currently deprecated because they</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   operate with classes that are deprecated themselves, but for future versions,</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   we plan to keep the functionality in new functions.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`correctionpoints.errors()` was deprecated in meteoland 2.0.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Current weather generation methods are currently deprecated because they</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   operate with classes that are deprecated themselves, but for future versions,</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   we plan to keep the functionality in new functions.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">meteoland</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue to the authors.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating area-averaged weather...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generating weather series...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Annual precipitation stats: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               average        sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> input/target 456.1522  83.63653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> simulated    450.0040 122.02284</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plot generated meteorological series</span></span></span>
<span class="r-in"><span><span class="fu"><a href="meteoplot.html">meteoplot</a></span><span class="op">(</span><span class="va">y</span>,<span class="fl">1</span>, ylab<span class="op">=</span><span class="st">"Mean temperature"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="weathergeneration-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres, Nicolas Martin, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

